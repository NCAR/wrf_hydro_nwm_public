program reservoir_unit_tests
    use module_levelpool_tests
    use module_persistence_levelpool_hybrid_tests

    implicit none

    logical :: rv1, rv2, rv3, rv4, rv5, rv2_LP, rv3_LP, rv4_LP          ! test result


    logical :: rv6, rv7, rv8, rv9, rv10



    rv1 = .false.
    rv2 = .false.
    rv3 = .false.

    rv1 = test_levelpool()

    !rv2 = test_persistence_levelpool_hybrid2()

    !rv2_LP = test_levelpool2()


    !rv3 = test_persistence_levelpool_hybrid3()

    !rv3_LP = test_levelpool3()

    !rv4 = test_persistence_levelpool_hybrid4()

    !rv4_LP = test_levelpool4()


    rv5 = test_persistence_levelpool_hybrid5()


!rv6 = test_persistence_levelpool_hybrid6()

!rv7 = test_persistence_levelpool_hybrid7()

!rv8 = test_persistence_levelpool_hybrid8()

!rv9 = test_persistence_levelpool_hybrid9()

!rv10 = test_persistence_levelpool_hybrid10()




!    if (rv1 .and. rv2) then
    if (rv1) then
        print *, "========================================================================"
        print *, 'All Reservoir Tests Passed'
        print *, "========================================================================"

    else
        print *, "========================================================================"
        print *, 'Not All Reservoir Tests Passed'
        print *, "========================================================================"
    end if


    contains

    !------------------------------------------------------------------------------!
    !                              test_levelpool()                                !
    ! this function verifies that the constructor for the levelpool type correctly !
    ! initializes all data members                                                 !
    !------------------------------------------------------------------------------!

    function test_levelpool() result(rv)
        implicit none

        logical rv                        ! test result
        logical :: call_status

        type (levelpool_struct) :: levelpool_reservoir_data
        real :: water_elevation = 2.
        !integer :: call_status = 0


        call_status = .false.

        print *, "calling init for levelpool_struct"
        call levelpool_reservoir_data%init(water_elevation, 4., 6., 8., 10., 12., 14., 16., 18., 20)

        print *, "testing data in levelpool_struct"
        call_status = levelpool_data_info(levelpool_reservoir_data)

        if (call_status) then
            rv = .true.
        end if

    end function test_levelpool



    !------------------------------------------------------------------------------!
    !                              test_levelpool()                                !
    ! this function verifies that the constructor for the levelpool type correctly !
    ! initializes all data members                                                 !
    !------------------------------------------------------------------------------!

    function test_persistence_levelpool_hybrid2() result(rv)

        implicit none

        logical rv, rv1, rv2, rv3                        ! test result

        type (persistence_levelpool_hybrid_struct) :: persistence_levelpool_hybrid_reservoir_data

        real :: outflow, inflow

        real :: water_elevation

        real :: prev_time_inflow

        !real, allocatable, dimension(:) :: inflow_array

        !real, dimension(108) :: inflow_array

real, dimension(108) :: inflow_array

        integer :: timestep_count

prev_time_inflow = 0.0

timestep_count = 0

        water_elevation = 0.0

        rv = .false.
        rv1 = .false.
        rv2 = .false.
        rv3 = .false.

        !allocate(inflow_array(108))


!inflow_array = (/91.7394, 92.15904, 92.1518,91.84663,91.38554,90.86131,90.32736,89.81273,89.3325,88.89427,88.5025,88.16228,87.41539,86.80043,86.03979,85.3849,85.33451,86.84274,91.6084,101.81398,118.85916,143.99232,177.7355,219.2348,267.22351,319.90402,374.54324,428.86066,480.92096,529.23584,572.77673,610.93237,643.4389,&
!670.28516,691.67767,707.96088,719.57312,726.96997,730.63269,731.03186,728.61438,723.79578,716.9549,708.43268,698.53247,687.52112,675.63123,663.06421,649.99976,636.57898,622.92926,609.1745,595.40369,581.68799,568.08588,554.64484,541.4032,528.39185,515.63513,503.14838,490.95123,479.05109,467.45493,456.16663,445.18753,434.51706,424.15311,414.0921,404.32956,394.86014,385.67789,376.77621,368.14966,359.78958,351.68875,343.83972,336.23505,328.86719,321.7287,314.81219,308.11047,301.61646,295.32312,289.22369,283.31207,277.5813,272.02521,266.63776,261.41315,256.34564,251.42978,246.66023,242.03192,237.53989,233.17944,228.94595,224.83511,220.84265,216.96449,213.19672,209.53554,205.97734,202.51857,199.1559,195.88605,192.70595,189.61255 /)


inflow_array = (/91.27196,&
91.7394,&
92.15904,&
92.1518,&
91.84663,&
91.38554,&
90.86131,&
90.32736,&
89.81273,&
89.3325,&
88.89427,&
88.5025,&
88.16228,&
87.41539,&
86.80043,&
86.03979,&
85.3849,&
85.33451,&
86.84274,&
91.6084,&
101.81398,&
118.85916,&
143.99232,&
177.7355,&
219.2348,&
267.22351,&
319.90402,&
374.54324,&
428.86066,&
480.92096,&
529.23584,&
572.77673,&
610.93237,&
643.4389,&
670.28516,&
691.67767,&
707.96088,&
719.57312,&
726.96997,&
730.63269,&
731.03186,&
728.61438,&
723.79578,&
716.9549,&
708.43268,&
698.53247,&
687.52112,&
675.63123,&
663.06421,&
649.99976,&
636.57898,&
622.92926,&
609.1745,&
595.40369,&
581.68799,&
568.08588,&
554.64484,&
541.4032,&
528.39185,&
515.63513,&
503.14838,&
490.95123,&
479.05109,&
467.45493,&
456.16663,&
445.18753,&
434.51706,&
424.15311,&
414.0921,&
404.32956,&
394.86014,&
385.67789,&
376.77621,&
368.14966,&
359.78958,&
351.68875,&
343.83972,&
336.23505,&
328.86719,&
321.7287,&
314.81219,&
308.11047,&
301.61646,&
295.32312,&
289.22369,&
283.31207,&
277.5813,&
272.02521,&
266.63776,&
261.41315,&
256.34564,&
251.42978,&
246.66023,&
242.03192,&
237.53989,&
233.17944,&
228.94595,&
224.83511,&
220.84265,&
216.96449,&
213.19672,&
209.53554,&
205.97734,&
202.51857,&
199.1559,&
195.88605,&
192.70595,&
189.61255 /)







!print *, inflow_array


        print *, "calling init for persistence_levelpool_hybrid_struct"
        call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, 1.509490013122558594e+01, 9.626000022888183238e+00 , &
        4.000000000000000222e-01, 1.000000000000000000e+01, 7.733333269755045869e+00, 1.000000000000000056e-01, 1.0, 9.960000038146972656e+00, 8.999999761581420898e-01, 166758723, "Testing_Files/hybrid_persistence_levelpool_ACF.nc", &
        "2010-10-01_07:00:00", "./Testing_Files/", 12, 1000000000)
        !"2010-10-01_07:00:00", "./Testing_Files/", 12, 86400)




        !call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, 123.829002380371, 63.6739971160889 , &
        !0.4, 10.0, 50.3799997965495, 0.1, 1.0, 66.0199966430664, 0.9, 16944276, "Testing_Files/hybrid_persistence_levelpool_ACF.nc", &
        !"2010-10-01_07:00:00", "", 12, 86400)


        print *, "testing data in persistence_levelpool_hybrid_struct"
        rv1 = persistence_levelpool_hybrid_data_info(persistence_levelpool_hybrid_reservoir_data)


        print *, "calling release for persistence_levelpool_hybrid_struct"


        water_elevation = 9.73733330


        do timestep_count = 1, 108

            inflow = inflow_array(timestep_count)
            call persistence_levelpool_hybrid_reservoir_data%run_release(inflow, &
            inflow, 0.0, water_elevation, outflow, 3600.0)

            prev_time_inflow = inflow

            print *, 'outflow'
            print *, outflow

        end do

        !print *, "outflow"
        !print *, outflow

        !if (outflow == 120.170197) then
        !    rv3 = .true.
        !    print *, "========================================================================"
        !    print *, 'Persistence Levelpool Hybrid Release Test Passed'
        !    print *, "========================================================================"
        !else
        !    print *, "========================================================================"
        !    print *, 'Persistence Levelpool Hybrid Release Test Failed'
        !    print *, 'Outflow should be 120.170197'
        !    print *, "========================================================================"
        !end if


        !if (rv1 .and. rv2 .and. rv3) then
        !    rv = .true.
        !end if

        if (rv1) then
            rv = .true.
        end if


    end function test_persistence_levelpool_hybrid2






    function test_levelpool2() result(rv)

        implicit none

        logical rv, rv1, rv2, rv3                        ! test result

        type (levelpool_struct) :: levelpool_reservoir_data

        real :: outflow, inflow

        real :: water_elevation

        real :: prev_time_inflow

        !real, allocatable, dimension(:) :: inflow_array

        !real, dimension(108) :: inflow_array

real, dimension(108) :: inflow_array

        integer :: timestep_count

prev_time_inflow = 0.0

timestep_count = 0

        water_elevation = 0.0

        rv = .false.
        rv1 = .false.
        rv2 = .false.
        rv3 = .false.


inflow_array = (/91.27196,&
91.7394,&
92.15904,&
92.1518,&
91.84663,&
91.38554,&
90.86131,&
90.32736,&
89.81273,&
89.3325,&
88.89427,&
88.5025,&
88.16228,&
87.41539,&
86.80043,&
86.03979,&
85.3849,&
85.33451,&
86.84274,&
91.6084,&
101.81398,&
118.85916,&
143.99232,&
177.7355,&
219.2348,&
267.22351,&
319.90402,&
374.54324,&
428.86066,&
480.92096,&
529.23584,&
572.77673,&
610.93237,&
643.4389,&
670.28516,&
691.67767,&
707.96088,&
719.57312,&
726.96997,&
730.63269,&
731.03186,&
728.61438,&
723.79578,&
716.9549,&
708.43268,&
698.53247,&
687.52112,&
675.63123,&
663.06421,&
649.99976,&
636.57898,&
622.92926,&
609.1745,&
595.40369,&
581.68799,&
568.08588,&
554.64484,&
541.4032,&
528.39185,&
515.63513,&
503.14838,&
490.95123,&
479.05109,&
467.45493,&
456.16663,&
445.18753,&
434.51706,&
424.15311,&
414.0921,&
404.32956,&
394.86014,&
385.67789,&
376.77621,&
368.14966,&
359.78958,&
351.68875,&
343.83972,&
336.23505,&
328.86719,&
321.7287,&
314.81219,&
308.11047,&
301.61646,&
295.32312,&
289.22369,&
283.31207,&
277.5813,&
272.02521,&
266.63776,&
261.41315,&
256.34564,&
251.42978,&
246.66023,&
242.03192,&
237.53989,&
233.17944,&
228.94595,&
224.83511,&
220.84265,&
216.96449,&
213.19672,&
209.53554,&
205.97734,&
202.51857,&
199.1559,&
195.88605,&
192.70595,&
189.61255 /)



print *, inflow_array

        !print *, "calling init for persistence_levelpool_hybrid_struct"
        !call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, 1.509490013122558594e+01, 9.626000022888183238e+00 , &
        !4.000000000000000222e-01, 1.000000000000000000e+01, 7.733333269755045869e+00, 1.000000000000000056e-01, 1.0, 9.960000038146972656e+00, 8.999999761581420898e-01, 166758723, "Testing_Files/hybrid_persistence_levelpool_ACF.nc", &
        !"2010-10-01_07:00:00", ".", 12, 86400)

        call levelpool_reservoir_data%init(water_elevation, 1.509490013122558594e+01, 9.626000022888183238e+00 , &
        4.000000000000000222e-01, 1.000000000000000000e+01, 7.733333269755045869e+00, 1.000000000000000056e-01, 1.0, 9.960000038146972656e+00, 16944276)


        !call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, 123.829002380371, 63.6739971160889 , &
        !0.4, 10.0, 50.3799997965495, 0.1, 1.0, 66.0199966430664, 0.9, 16944276, "Testing_Files/hybrid_persistence_levelpool_ACF.nc", &
        !"2010-10-01_07:00:00", ".", 12, 86400)


        !print *, "testing data in persistence_levelpool_hybrid_struct"
        !rv1 = persistence_levelpool_hybrid_data_info(persistence_levelpool_hybrid_reservoir_data)


        !print *, "calling release for persistence_levelpool_hybrid_struct"


        water_elevation = 9.73733330


        do timestep_count = 1, 108

            inflow = inflow_array(timestep_count)
            call levelpool_reservoir_data%run_release(inflow, &
            inflow, 0.0, water_elevation, outflow, 300.0)

            prev_time_inflow = inflow

        end do

        !print *, "outflow"
        !print *, outflow

        !if (outflow == 120.170197) then
        !    rv3 = .true.
        !    print *, "========================================================================"
        !    print *, 'Persistence Levelpool Hybrid Release Test Passed'
        !    print *, "========================================================================"
        !else
        !    print *, "========================================================================"
        !    print *, 'Persistence Levelpool Hybrid Release Test Failed'
        !    print *, 'Outflow should be 120.170197'
        !    print *, "========================================================================"
        !end if


        !if (rv1 .and. rv2 .and. rv3) then
        !    rv = .true.
        !end if

        !if (rv1) then
        !    rv = .true.
        !end if


    end function test_levelpool2














    function test_persistence_levelpool_hybrid3() result(rv)

        implicit none

        logical rv, rv1, rv2, rv3                        ! test result

        type (persistence_levelpool_hybrid_struct) :: persistence_levelpool_hybrid_reservoir_data

        real :: outflow, inflow

        real :: water_elevation

        real :: prev_time_inflow


        !real, allocatable, dimension(:) :: inflow_array

        !real, dimension(108) :: inflow_array

real, dimension(108) :: inflow_array

        integer :: timestep_count

prev_time_inflow = 0.0


timestep_count = 0

        water_elevation = 0.0

        rv = .false.
        rv1 = .false.
        rv2 = .false.
        rv3 = .false.


        !allocate(inflow_array(108))


!inflow_array = (/91.7394, 92.15904, 92.1518,91.84663,91.38554,90.86131,90.32736,89.81273,89.3325,88.89427,88.5025,88.16228,87.41539,86.80043,86.03979,85.3849,85.33451,86.84274,91.6084,101.81398,118.85916,143.99232,177.7355,219.2348,267.22351,319.90402,374.54324,428.86066,480.92096,529.23584,572.77673,610.93237,643.4389,&
!670.28516,691.67767,707.96088,719.57312,726.96997,730.63269,731.03186,728.61438,723.79578,716.9549,708.43268,698.53247,687.52112,675.63123,663.06421,649.99976,636.57898,622.92926,609.1745,595.40369,581.68799,568.08588,554.64484,541.4032,528.39185,515.63513,503.14838,490.95123,479.05109,467.45493,456.16663,445.18753,434.51706,424.15311,414.0921,404.32956,394.86014,385.67789,376.77621,368.14966,359.78958,351.68875,343.83972,336.23505,328.86719,321.7287,314.81219,308.11047,301.61646,295.32312,289.22369,283.31207,277.5813,272.02521,266.63776,261.41315,256.34564,251.42978,246.66023,242.03192,237.53989,233.17944,228.94595,224.83511,220.84265,216.96449,213.19672,209.53554,205.97734,202.51857,199.1559,195.88605,192.70595,189.61255 /)


inflow_array = (/16.41417,&
16.34501,&
16.27684,&
16.20959,&
16.14314,&
16.07742,&
16.01236,&
15.94794,&
15.88411,&
15.82085,&
15.75815,&
15.69599,&
15.63438,&
15.57332,&
15.51281,&
15.45285,&
15.39345,&
15.33467,&
15.27646,&
15.21883,&
15.16178,&
15.10531,&
15.04943,&
14.99415,&
14.93946,&
14.88537,&
14.83189,&
14.779,&
14.72671,&
14.67501,&
14.62391,&
14.57339,&
14.52347,&
14.47413,&
14.42537,&
14.37718,&
14.32957,&
14.28253,&
14.23605,&
14.19012,&
14.14475,&
14.09992,&
14.05562,&
14.01186,&
13.96862,&
13.92589,&
13.88368,&
13.84198,&
13.80077,&
13.76007,&
13.71986,&
13.68012,&
13.64086,&
13.60207,&
13.56374,&
13.52586,&
13.48843,&
13.45144,&
13.41489,&
13.37877,&
13.34307,&
13.30781,&
13.27295,&
13.23851,&
13.20446,&
13.17081,&
13.13755,&
13.10467,&
13.07217,&
13.04005,&
13.00829,&
12.9769,&
12.94586,&
12.91519,&
12.88487,&
12.85489,&
12.82525,&
12.79594,&
12.76696,&
12.73831,&
12.70997,&
12.68195,&
12.65424,&
12.62684,&
12.59974,&
12.57295,&
12.54646,&
12.52025,&
12.49433,&
12.46869,&
12.44333,&
12.41825,&
12.39343,&
12.36889,&
12.3446,&
12.32058,&
12.29681,&
12.27331,&
12.25006,&
12.22705,&
12.20428,&
12.18176,&
12.15947,&
12.13741,&
12.11559,&
12.09399,&
12.07262,&
12.05147 /)





!print *, inflow_array


        print *, "calling init for persistence_levelpool_hybrid_struct"
        call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, 1.306920051574707031e+00, 2.106899932861328182e+02 , &
        4.000000000000000222e-01, 1.000000000000000000e+01, 2.101233266194661553e+02, 1.000000000000000056e-01, 1.0, 2.107899932861328125e+02, 8.999999761581420898e-01, 10361596, "Testing_Files/hybrid_persistence_levelpool_ACF.nc", &
        "2010-10-01_07:00:00", ".", 12, 86400)




        !call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, 123.829002380371, 63.6739971160889 , &
        !0.4, 10.0, 50.3799997965495, 0.1, 1.0, 66.0199966430664, 0.9, 16944276, "Testing_Files/hybrid_persistence_levelpool_ACF.nc", &
        !"2010-10-01_07:00:00", ".", 12, 86400)


        print *, "testing data in persistence_levelpool_hybrid_struct"
        rv1 = persistence_levelpool_hybrid_data_info(persistence_levelpool_hybrid_reservoir_data)


        print *, "calling release for persistence_levelpool_hybrid_struct"


        water_elevation = 210.723328


        do timestep_count = 1, 108

            inflow = inflow_array(timestep_count)
            call persistence_levelpool_hybrid_reservoir_data%run_release(inflow, &
            inflow, 0.0, water_elevation, outflow, 300.0)

            prev_time_inflow = inflow


        end do

        !print *, "outflow"
        !print *, outflow

        !if (outflow == 120.170197) then
        !    rv3 = .true.
        !    print *, "========================================================================"
        !    print *, 'Persistence Levelpool Hybrid Release Test Passed'
        !    print *, "========================================================================"
        !else
        !    print *, "========================================================================"
        !    print *, 'Persistence Levelpool Hybrid Release Test Failed'
        !    print *, 'Outflow should be 120.170197'
        !    print *, "========================================================================"
        !end if


        !if (rv1 .and. rv2 .and. rv3) then
        !    rv = .true.
        !end if

        if (rv1) then
            rv = .true.
        end if


    end function test_persistence_levelpool_hybrid3




    function test_levelpool3() result(rv)

        implicit none

        logical rv, rv1, rv2, rv3                        ! test result

        type (levelpool_struct) :: levelpool_reservoir_data

        real :: outflow, inflow

        real :: water_elevation

        real :: prev_time_inflow

        !real, allocatable, dimension(:) :: inflow_array

        !real, dimension(108) :: inflow_array

real, dimension(108) :: inflow_array

        integer :: timestep_count

prev_time_inflow = 0.0

timestep_count = 0

        water_elevation = 0.0

        rv = .false.
        rv1 = .false.
        rv2 = .false.
        rv3 = .false.


inflow_array = (/16.41417,&
16.34501,&
16.27684,&
16.20959,&
16.14314,&
16.07742,&
16.01236,&
15.94794,&
15.88411,&
15.82085,&
15.75815,&
15.69599,&
15.63438,&
15.57332,&
15.51281,&
15.45285,&
15.39345,&
15.33467,&
15.27646,&
15.21883,&
15.16178,&
15.10531,&
15.04943,&
14.99415,&
14.93946,&
14.88537,&
14.83189,&
14.779,&
14.72671,&
14.67501,&
14.62391,&
14.57339,&
14.52347,&
14.47413,&
14.42537,&
14.37718,&
14.32957,&
14.28253,&
14.23605,&
14.19012,&
14.14475,&
14.09992,&
14.05562,&
14.01186,&
13.96862,&
13.92589,&
13.88368,&
13.84198,&
13.80077,&
13.76007,&
13.71986,&
13.68012,&
13.64086,&
13.60207,&
13.56374,&
13.52586,&
13.48843,&
13.45144,&
13.41489,&
13.37877,&
13.34307,&
13.30781,&
13.27295,&
13.23851,&
13.20446,&
13.17081,&
13.13755,&
13.10467,&
13.07217,&
13.04005,&
13.00829,&
12.9769,&
12.94586,&
12.91519,&
12.88487,&
12.85489,&
12.82525,&
12.79594,&
12.76696,&
12.73831,&
12.70997,&
12.68195,&
12.65424,&
12.62684,&
12.59974,&
12.57295,&
12.54646,&
12.52025,&
12.49433,&
12.46869,&
12.44333,&
12.41825,&
12.39343,&
12.36889,&
12.3446,&
12.32058,&
12.29681,&
12.27331,&
12.25006,&
12.22705,&
12.20428,&
12.18176,&
12.15947,&
12.13741,&
12.11559,&
12.09399,&
12.07262,&
12.05147 /)



!print *, inflow_array

        !print *, "calling init for persistence_levelpool_hybrid_struct"
        !call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, 1.509490013122558594e+01, 9.626000022888183238e+00 , &
        !4.000000000000000222e-01, 1.000000000000000000e+01, 7.733333269755045869e+00, 1.000000000000000056e-01, 1.0, 9.960000038146972656e+00, 8.999999761581420898e-01, 166758723, "Testing_Files/hybrid_persistence_levelpool_ACF.nc", &
        !"2010-10-01_07:00:00", ".", 12, 86400)

        call levelpool_reservoir_data%init(water_elevation, 1.306920051574707031e+00, 2.106899932861328182e+02 , &
        4.000000000000000222e-01, 1.000000000000000000e+01, 2.101233266194661553e+02, 1.000000000000000056e-01, 1.0, 2.107899932861328125e+02, 14785127)




        !call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, 123.829002380371, 63.6739971160889 , &
        !0.4, 10.0, 50.3799997965495, 0.1, 1.0, 66.0199966430664, 0.9, 16944276, "Testing_Files/hybrid_persistence_levelpool_ACF.nc", &
        !"2010-10-01_07:00:00", ".", 12, 86400)


        !print *, "testing data in persistence_levelpool_hybrid_struct"
        !rv1 = persistence_levelpool_hybrid_data_info(persistence_levelpool_hybrid_reservoir_data)


        !print *, "calling release for persistence_levelpool_hybrid_struct"


        water_elevation = 210.723328


        do timestep_count = 1, 108

            inflow = inflow_array(timestep_count)
            call levelpool_reservoir_data%run_release(inflow, &
            inflow, 0.0, water_elevation, outflow, 300.0)

            prev_time_inflow = inflow

        end do

        !print *, "outflow"
        !print *, outflow

        !if (outflow == 120.170197) then
        !    rv3 = .true.
        !    print *, "========================================================================"
        !    print *, 'Persistence Levelpool Hybrid Release Test Passed'
        !    print *, "========================================================================"
        !else
        !    print *, "========================================================================"
        !    print *, 'Persistence Levelpool Hybrid Release Test Failed'
        !    print *, 'Outflow should be 120.170197'
        !    print *, "========================================================================"
        !end if


        !if (rv1 .and. rv2 .and. rv3) then
        !    rv = .true.
        !end if

        !if (rv1) then
        !    rv = .true.
        !end if


    end function test_levelpool3

















!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!





    function test_persistence_levelpool_hybrid4() result(rv)

        implicit none

        logical rv, rv1, rv2, rv3                        ! test result

        type (persistence_levelpool_hybrid_struct) :: persistence_levelpool_hybrid_reservoir_data

        real :: outflow, inflow

        real :: water_elevation

        real :: prev_time_inflow


        !real, allocatable, dimension(:) :: inflow_array

        !real, dimension(108) :: inflow_array

real, dimension(108) :: inflow_array

        integer :: timestep_count

prev_time_inflow = 0.0


timestep_count = 0

        water_elevation = 0.0

        rv = .false.
        rv1 = .false.
        rv2 = .false.
        rv3 = .false.


        !allocate(inflow_array(108))


!inflow_array = (/91.7394, 92.15904, 92.1518,91.84663,91.38554,90.86131,90.32736,89.81273,89.3325,88.89427,88.5025,88.16228,87.41539,86.80043,86.03979,85.3849,85.33451,86.84274,91.6084,101.81398,118.85916,143.99232,177.7355,219.2348,267.22351,319.90402,374.54324,428.86066,480.92096,529.23584,572.77673,610.93237,643.4389,&
!670.28516,691.67767,707.96088,719.57312,726.96997,730.63269,731.03186,728.61438,723.79578,716.9549,708.43268,698.53247,687.52112,675.63123,663.06421,649.99976,636.57898,622.92926,609.1745,595.40369,581.68799,568.08588,554.64484,541.4032,528.39185,515.63513,503.14838,490.95123,479.05109,467.45493,456.16663,445.18753,434.51706,424.15311,414.0921,404.32956,394.86014,385.67789,376.77621,368.14966,359.78958,351.68875,343.83972,336.23505,328.86719,321.7287,314.81219,308.11047,301.61646,295.32312,289.22369,283.31207,277.5813,272.02521,266.63776,261.41315,256.34564,251.42978,246.66023,242.03192,237.53989,233.17944,228.94595,224.83511,220.84265,216.96449,213.19672,209.53554,205.97734,202.51857,199.1559,195.88605,192.70595,189.61255 /)


inflow_array = (/154.6527557,&
154.6150208,&
154.5515594,&
154.4784851,&
154.401947,&
154.3236237,&
154.2500153,&
154.1869202,&
154.1379547,&
154.1045227,&
154.0855103,&
154.0786591,&
154.0811462,&
154.091156,&
154.1060638,&
154.124649,&
154.1455841,&
154.1681061,&
154.1914825,&
154.2156067,&
154.2402496,&
154.265274,&
154.290329,&
154.3154297,&
154.3404236,&
154.3651428,&
154.3896179,&
154.4137573,&
154.4375305,&
154.4608765,&
154.4837799,&
154.5061493,&
154.5280914,&
154.5495911,&
154.5706787,&
154.5909729,&
154.6102448,&
154.6286469,&
154.6462097,&
154.6630859,&
154.6792908,&
154.6948242,&
154.7098236,&
154.72435,&
154.7385406,&
154.7523041,&
154.7657166,&
154.7785797,&
154.7910004,&
154.8029327,&
154.8143463,&
154.8252411,&
154.8355865,&
154.845459,&
154.8547211,&
154.8634796,&
154.8718109,&
154.8796082,&
154.8869781,&
154.8937378,&
154.8998413,&
154.9054108,&
154.9104919,&
154.9155273,&
154.9200439,&
154.9244385,&
154.928833,&
154.9334259,&
154.9382172,&
154.9434357,&
154.9489899,&
154.9550781,&
154.9614105,&
154.9675446,&
154.9744415,&
154.9818573,&
154.9893341,&
154.996933,&
155.0048218,&
155.013092,&
155.0214996,&
155.029953,&
155.0383301,&
155.0466156,&
155.0545349,&
155.0620575,&
155.0691223,&
155.075882,&
155.0821075,&
155.0880585,&
155.093811,&
155.0994568,&
155.10495,&
155.1104279,&
155.1572266,&
155.4083099,&
155.5628357,&
155.5335083,&
155.5141449,&
155.5797882,&
155.7202911,&
155.786911,&
155.7349854,&
155.6275024,&
155.5153656,&
155.4232025,&
155.3576202,&
155.3176422 /)





!print *, inflow_array


        print *, "calling init for persistence_levelpool_hybrid_struct"
        !call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, 1.306920051574707031e+00, 2.106899932861328182e+02 , &
        !4.000000000000000222e-01, 1.000000000000000000e+01, 2.101233266194661553e+02, 1.000000000000000056e-01, 1.0, 2.107899932861328125e+02, 8.999999761581420898e-01, 10361596, "Testing_Files/hybrid_persistence_levelpool_ACF.nc", &
        !"2010-10-01_07:00:00", ".", 12, 86400)



        call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, 94.41929626, 763.92398682, &
        4.000000000000000222e-01, 1.000000000000000000e+01, 699.45998128, 1.000000000000000056e-01, 1.0, 775.29998779, 8.999999761581420898e-01, 10361596, "Testing_Files/hybrid_persistence_levelpool_ACF.nc", &
        "2010-10-01_07:00:00", ".", 12, 86400)



        !call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, 123.829002380371, 63.6739971160889 , &
        !0.4, 10.0, 50.3799997965495, 0.1, 1.0, 66.0199966430664, 0.9, 16944276, "Testing_Files/hybrid_persistence_levelpool_ACF.nc", &
        !"2010-10-01_07:00:00", ".", 12, 86400)


        print *, "testing data in persistence_levelpool_hybrid_struct"
        rv1 = persistence_levelpool_hybrid_data_info(persistence_levelpool_hybrid_reservoir_data)


        print *, "calling release for persistence_levelpool_hybrid_struct"


        water_elevation = 767.716003


        do timestep_count = 1, 108

            inflow = inflow_array(timestep_count)
            call persistence_levelpool_hybrid_reservoir_data%run_release(inflow, &
            inflow, 0.0, water_elevation, outflow, 300.0)

            prev_time_inflow = inflow


        end do

        !print *, "outflow"
        !print *, outflow

        !if (outflow == 120.170197) then
        !    rv3 = .true.
        !    print *, "========================================================================"
        !    print *, 'Persistence Levelpool Hybrid Release Test Passed'
        !    print *, "========================================================================"
        !else
        !    print *, "========================================================================"
        !    print *, 'Persistence Levelpool Hybrid Release Test Failed'
        !    print *, 'Outflow should be 120.170197'
        !    print *, "========================================================================"
        !end if


        !if (rv1 .and. rv2 .and. rv3) then
        !    rv = .true.
        !end if

        if (rv1) then
            rv = .true.
        end if


    end function test_persistence_levelpool_hybrid4




    function test_levelpool4() result(rv)

        implicit none

        logical rv, rv1, rv2, rv3                        ! test result

        type (levelpool_struct) :: levelpool_reservoir_data

        real :: outflow, inflow

        real :: water_elevation

        real :: prev_time_inflow

        !real, allocatable, dimension(:) :: inflow_array

        !real, dimension(108) :: inflow_array

real, dimension(108) :: inflow_array

        integer :: timestep_count

prev_time_inflow = 0.0

timestep_count = 0

        water_elevation = 0.0

        rv = .false.
        rv1 = .false.
        rv2 = .false.
        rv3 = .false.


inflow_array = (/154.6527557,&
154.6150208,&
154.5515594,&
154.4784851,&
154.401947,&
154.3236237,&
154.2500153,&
154.1869202,&
154.1379547,&
154.1045227,&
154.0855103,&
154.0786591,&
154.0811462,&
154.091156,&
154.1060638,&
154.124649,&
154.1455841,&
154.1681061,&
154.1914825,&
154.2156067,&
154.2402496,&
154.265274,&
154.290329,&
154.3154297,&
154.3404236,&
154.3651428,&
154.3896179,&
154.4137573,&
154.4375305,&
154.4608765,&
154.4837799,&
154.5061493,&
154.5280914,&
154.5495911,&
154.5706787,&
154.5909729,&
154.6102448,&
154.6286469,&
154.6462097,&
154.6630859,&
154.6792908,&
154.6948242,&
154.7098236,&
154.72435,&
154.7385406,&
154.7523041,&
154.7657166,&
154.7785797,&
154.7910004,&
154.8029327,&
154.8143463,&
154.8252411,&
154.8355865,&
154.845459,&
154.8547211,&
154.8634796,&
154.8718109,&
154.8796082,&
154.8869781,&
154.8937378,&
154.8998413,&
154.9054108,&
154.9104919,&
154.9155273,&
154.9200439,&
154.9244385,&
154.928833,&
154.9334259,&
154.9382172,&
154.9434357,&
154.9489899,&
154.9550781,&
154.9614105,&
154.9675446,&
154.9744415,&
154.9818573,&
154.9893341,&
154.996933,&
155.0048218,&
155.013092,&
155.0214996,&
155.029953,&
155.0383301,&
155.0466156,&
155.0545349,&
155.0620575,&
155.0691223,&
155.075882,&
155.0821075,&
155.0880585,&
155.093811,&
155.0994568,&
155.10495,&
155.1104279,&
155.1572266,&
155.4083099,&
155.5628357,&
155.5335083,&
155.5141449,&
155.5797882,&
155.7202911,&
155.786911,&
155.7349854,&
155.6275024,&
155.5153656,&
155.4232025,&
155.3576202,&
155.3176422 /)




!print *, inflow_array

        !print *, "calling init for persistence_levelpool_hybrid_struct"
        !call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, 1.509490013122558594e+01, 9.626000022888183238e+00 , &
        !4.000000000000000222e-01, 1.000000000000000000e+01, 7.733333269755045869e+00, 1.000000000000000056e-01, 1.0, 9.960000038146972656e+00, 8.999999761581420898e-01, 166758723, "Testing_Files/hybrid_persistence_levelpool_ACF.nc", &
        !"2010-10-01_07:00:00", ".", 12, 86400)

        call levelpool_reservoir_data%init(water_elevation, 94.41929626, 763.92398682, &
        4.000000000000000222e-01, 1.000000000000000000e+01, 699.45998128, 1.000000000000000056e-01, 1.0, 775.29998779, 22886855)




        !call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, 123.829002380371, 63.6739971160889 , &
        !0.4, 10.0, 50.3799997965495, 0.1, 1.0, 66.0199966430664, 0.9, 16944276, "Testing_Files/hybrid_persistence_levelpool_ACF.nc", &
        !"2010-10-01_07:00:00", ".", 12, 86400)


        !print *, "testing data in persistence_levelpool_hybrid_struct"
        !rv1 = persistence_levelpool_hybrid_data_info(persistence_levelpool_hybrid_reservoir_data)


        !print *, "calling release for persistence_levelpool_hybrid_struct"


        water_elevation = 260.5342102


        do timestep_count = 1, 108

            inflow = inflow_array(timestep_count)
            call levelpool_reservoir_data%run_release(inflow, &
            inflow, 0.0, water_elevation, outflow, 3600.0)

            prev_time_inflow = inflow

        end do

        !print *, "outflow"
        !print *, outflow

        !if (outflow == 120.170197) then
        !    rv3 = .true.
        !    print *, "========================================================================"
        !    print *, 'Persistence Levelpool Hybrid Release Test Passed'
        !    print *, "========================================================================"
        !else
        !    print *, "========================================================================"
        !    print *, 'Persistence Levelpool Hybrid Release Test Failed'
        !    print *, 'Outflow should be 120.170197'
        !    print *, "========================================================================"
        !end if


        !if (rv1 .and. rv2 .and. rv3) then
        !    rv = .true.
        !end if

        !if (rv1) then
        !    rv = .true.
        !end if


    end function test_levelpool4



    function test_persistence_levelpool_hybrid5() result(rv)

        implicit none

        logical rv, rv1, rv2, rv3                        ! test result

        type (persistence_levelpool_hybrid_struct) :: persistence_levelpool_hybrid_reservoir_data

        real :: outflow, inflow

        real :: water_elevation

        real :: prev_time_inflow


        real :: lake_area, weir_elevation, weir_coeffecient
        real :: weir_length, orifice_elevation, orifice_coefficient
        real :: orifice_area, max_depth, initial_fractional_depth
        integer :: lake_number

        !real, allocatable, dimension(:) :: inflow_array

        !real, dimension(108) :: inflow_array

real, dimension(2880) :: inflow_array

        integer :: timestep_count

prev_time_inflow = 0.0


timestep_count = 0

        water_elevation = 0.0

        rv = .false.
        rv1 = .false.
        rv2 = .false.
        rv3 = .false.






        !allocate(inflow_array(108))


!inflow_array = (/91.7394, 92.15904, 92.1518,91.84663,91.38554,90.86131,90.32736,89.81273,89.3325,88.89427,88.5025,88.16228,87.41539,86.80043,86.03979,85.3849,85.33451,86.84274,91.6084,101.81398,118.85916,143.99232,177.7355,219.2348,267.22351,319.90402,374.54324,428.86066,480.92096,529.23584,572.77673,610.93237,643.4389,&
!670.28516,691.67767,707.96088,719.57312,726.96997,730.63269,731.03186,728.61438,723.79578,716.9549,708.43268,698.53247,687.52112,675.63123,663.06421,649.99976,636.57898,622.92926,609.1745,595.40369,581.68799,568.08588,554.64484,541.4032,528.39185,515.63513,503.14838,490.95123,479.05109,467.45493,456.16663,445.18753,434.51706,424.15311,414.0921,404.32956,394.86014,385.67789,376.77621,368.14966,359.78958,351.68875,343.83972,336.23505,328.86719,321.7287,314.81219,308.11047,301.61646,295.32312,289.22369,283.31207,277.5813,272.02521,266.63776,261.41315,256.34564,251.42978,246.66023,242.03192,237.53989,233.17944,228.94595,224.83511,220.84265,216.96449,213.19672,209.53554,205.97734,202.51857,199.1559,195.88605,192.70595,189.61255 /)


inflow_array = (/189.22899	,&
189.27005	,&
189.31049	,&
189.35042	,&
189.38965	,&
189.42819	,&
189.46588	,&
189.50273	,&
189.53859	,&
189.57346	,&
189.60719	,&
189.63979	,&
189.6711	,&
189.7011	,&
189.72968	,&
189.75679	,&
189.7823	,&
189.80617	,&
189.82822	,&
189.84842	,&
189.86653	,&
189.88255	,&
189.89622	,&
189.90752	,&
189.91612	,&
189.922	,&
189.92482	,&
189.92447	,&
189.92067	,&
189.91319	,&
189.90175	,&
189.88611	,&
189.86592	,&
189.84088	,&
189.81064	,&
189.77487	,&
189.73317	,&
189.6852	,&
189.63051	,&
189.56873	,&
189.49939	,&
189.42207	,&
189.33635	,&
189.24176	,&
189.13782	,&
189.02408	,&
188.90009	,&
188.76535	,&
188.61945	,&
188.46188	,&
188.29224	,&
188.11006	,&
187.91493	,&
187.70644	,&
187.48419	,&
187.24779	,&
186.9969	,&
186.73119	,&
186.45035	,&
186.15407	,&
185.84213	,&
185.51424	,&
185.17023	,&
184.80989	,&
184.43312	,&
184.03975	,&
183.62973	,&
183.20296	,&
182.75943	,&
182.29909	,&
181.82205	,&
181.32828	,&
180.81792	,&
180.29099	,&
179.74774	,&
179.1882	,&
178.61267	,&
178.02129	,&
177.41437	,&
176.79207	,&
176.15475	,&
175.50269	,&
174.83627	,&
174.15576	,&
173.46162	,&
172.75417	,&
172.03389	,&
171.3011	,&
170.55634	,&
169.79997	,&
169.03255	,&
168.25441	,&
167.46616	,&
166.66815	,&
165.86099	,&
165.04509	,&
164.22101	,&
163.38913	,&
162.55011	,&
161.70428	,&
160.85229	,&
159.99452	,&
159.13156	,&
158.26382	,&
157.39188	,&
156.51611	,&
155.63715	,&
154.75531	,&
153.8712	,&
152.98517	,&
152.09779	,&
151.2094	,&
150.32057	,&
149.43166	,&
148.54315	,&
147.6554	,&
146.76892	,&
145.88405	,&
145.00128	,&
144.12091	,&
143.24345	,&
142.36917	,&
141.49855	,&
140.63187	,&
139.76959	,&
138.91199	,&
138.05948	,&
137.2123	,&
136.3709	,&
135.53551	,&
134.70654	,&
133.8842	,&
133.06891	,&
132.26085	,&
131.4604	,&
130.6678	,&
129.88339	,&
129.10733	,&
128.33997	,&
127.58147	,&
126.8322	,&
126.09231	,&
125.36215	,&
124.64187	,&
123.93182	,&
123.23199	,&
122.5427	,&
121.86401	,&
121.1963	,&
120.53969	,&
119.89458	,&
119.26109	,&
118.63963	,&
118.03033	,&
117.43356	,&
116.84944	,&
116.27835	,&
115.72038	,&
115.17589	,&
114.64497	,&
114.12795	,&
113.62492	,&
113.1362	,&
112.66186	,&
112.20218	,&
111.75725	,&
111.32734	,&
110.91252	,&
110.51296	,&
110.12882	,&
109.76028	,&
109.40737	,&
109.07025	,&
108.74899	,&
108.44374	,&
108.15457	,&
107.88166	,&
107.62505	,&
107.38489	,&
107.16121	,&
106.95414	,&
106.76369	,&
106.58997	,&
106.43296	,&
106.29273	,&
106.16925	,&
106.06255	,&
105.97257	,&
105.89933	,&
105.84274	,&
105.80275	,&
105.77927	,&
105.77224	,&
105.78152	,&
105.80702	,&
105.84855	,&
105.90601	,&
105.9792	,&
106.06792	,&
106.17201	,&
106.29124	,&
106.4254	,&
106.57423	,&
106.73747	,&
106.91489	,&
107.10619	,&
107.31108	,&
107.52926	,&
107.76039	,&
108.00418	,&
108.26026	,&
108.52832	,&
108.80796	,&
109.09881	,&
109.40051	,&
109.71265	,&
110.03487	,&
110.36671	,&
110.70778	,&
111.05766	,&
111.4159	,&
111.78207	,&
112.15575	,&
112.53648	,&
112.92378	,&
113.31724	,&
113.71638	,&
114.12071	,&
114.52982	,&
114.94321	,&
115.36041	,&
115.78099	,&
116.20445	,&
116.63035	,&
117.05823	,&
117.48762	,&
117.91806	,&
118.34911	,&
118.78033	,&
119.2113	,&
119.64155	,&
120.07066	,&
120.49822	,&
120.92382	,&
121.34705	,&
121.76752	,&
122.18484	,&
122.59866	,&
123.00855	,&
123.41422	,&
123.8153	,&
124.21145	,&
124.60234	,&
124.98767	,&
125.36713	,&
125.74041	,&
126.10729	,&
126.46745	,&
126.82066	,&
127.16668	,&
127.50527	,&
127.83623	,&
128.15935	,&
128.47441	,&
128.78125	,&
129.07968	,&
129.36958	,&
129.65077	,&
129.92314	,&
130.18655	,&
130.44089	,&
130.68605	,&
130.92198	,&
131.14856	,&
131.36572	,&
131.57343	,&
131.77161	,&
131.96025	,&
132.1393	,&
132.30873	,&
132.46857	,&
132.61876	,&
132.75935	,&
132.89032	,&
133.01172	,&
133.12355	,&
133.22585	,&
133.31866	,&
133.40204	,&
133.47601	,&
133.54068	,&
133.59607	,&
133.64227	,&
133.67937	,&
133.70743	,&
133.72655	,&
133.73682	,&
133.73834	,&
133.73123	,&
133.71558	,&
133.6915	,&
133.6591	,&
133.61853	,&
133.56987	,&
133.51328	,&
133.44885	,&
133.37674	,&
133.29704	,&
133.20993	,&
133.11552	,&
133.01396	,&
132.90536	,&
132.78987	,&
132.66763	,&
132.53879	,&
132.40344	,&
132.26178	,&
132.11391	,&
131.95998	,&
131.80011	,&
131.63448	,&
131.46315	,&
131.28633	,&
131.10411	,&
130.91664	,&
130.72404	,&
130.52646	,&
130.32402	,&
130.11684	,&
129.90506	,&
129.68878	,&
129.46815	,&
129.24329	,&
129.0143	,&
128.78133	,&
128.54445	,&
128.30382	,&
128.05951	,&
127.81167	,&
127.56042	,&
127.30582	,&
127.04801	,&
126.78707	,&
126.52312	,&
126.25626	,&
125.98657	,&
125.71417	,&
125.43911	,&
125.16152	,&
124.88151	,&
124.59912	,&
124.31448	,&
124.02761	,&
123.73864	,&
123.44765	,&
123.15466	,&
122.85982	,&
122.56319	,&
122.26485	,&
121.96489	,&
121.66334	,&
121.36033	,&
121.05585	,&
120.75002	,&
120.44287	,&
120.13449	,&
119.82492	,&
119.51424	,&
119.20248	,&
118.88973	,&
118.57603	,&
118.26144	,&
117.94598	,&
117.62975	,&
117.31276	,&
116.99509	,&
116.67677	,&
116.35786	,&
116.03839	,&
115.71841	,&
115.39796	,&
115.07709	,&
114.75582	,&
114.43423	,&
114.11229	,&
113.79011	,&
113.46767	,&
113.14506	,&
112.82226	,&
112.49934	,&
112.17632	,&
111.85323	,&
111.5301	,&
111.20696	,&
110.88383	,&
110.56077	,&
110.23776	,&
109.91488	,&
109.5921	,&
109.26949	,&
108.94705	,&
108.62482	,&
108.30282	,&
107.98106	,&
107.65955	,&
107.33834	,&
107.01743	,&
106.69685	,&
106.37662	,&
106.05676	,&
105.73727	,&
105.4182	,&
105.09951	,&
104.78127	,&
104.46343	,&
104.14609	,&
103.82922	,&
103.51286	,&
103.19703	,&
102.88174	,&
102.56696	,&
102.25275	,&
101.93908	,&
101.626	,&
101.31347	,&
101.00155	,&
100.69022	,&
100.37951	,&
100.06942	,&
99.75997	,&
99.45116	,&
99.14301	,&
98.8355	,&
98.52868	,&
98.22252	,&
97.91707	,&
97.61227	,&
97.3082	,&
97.00483	,&
96.70217	,&
96.40022	,&
96.099	,&
95.79849	,&
95.49874	,&
95.19971	,&
94.90146	,&
94.60394	,&
94.30719	,&
94.01118	,&
93.71597	,&
93.42105	,&
93.12703	,&
92.8334	,&
92.53862	,&
92.24693	,&
91.95422	,&
91.66428	,&
91.3734	,&
91.08512	,&
90.79597	,&
90.50935	,&
90.22189	,&
89.9369	,&
89.65112	,&
89.36778	,&
89.08369	,&
88.80201	,&
88.51961	,&
88.23957	,&
87.95885	,&
87.68047	,&
87.40144	,&
87.12469	,&
86.84737	,&
86.57229	,&
86.29665	,&
86.02323	,&
85.74929	,&
85.47755	,&
85.2053	,&
84.93522	,&
84.66466	,&
84.39622	,&
84.12736	,&
83.86059	,&
83.59341	,&
83.32829	,&
83.06279	,&
82.79932	,&
82.53551	,&
82.2737	,&
82.01156	,&
81.75138	,&
81.49091	,&
81.23238	,&
80.97358	,&
80.71667	,&
80.45951	,&
80.20424	,&
79.94873	,&
79.69507	,&
79.44122	,&
79.18917	,&
78.93697	,&
78.68658	,&
78.43565	,&
78.18702	,&
77.93798	,&
77.68955	,&
77.44334	,&
77.19671	,&
76.95075	,&
76.70686	,&
76.46265	,&
76.21906	,&
75.97748	,&
75.7356	,&
75.49435	,&
75.25503	,&
75.01548	,&
74.77653	,&
74.53928	,&
74.30172	,&
74.06486	,&
73.82882	,&
73.59363	,&
73.3592	,&
73.12555	,&
72.89263	,&
72.66048	,&
72.42905	,&
72.19837	,&
71.96838	,&
71.73912	,&
71.51057	,&
71.28274	,&
71.0556	,&
70.82917	,&
70.60342	,&
70.37838	,&
70.15401	,&
69.93033	,&
69.70731	,&
69.48498	,&
69.2633	,&
69.0423	,&
68.82194	,&
68.60224	,&
68.38318	,&
68.16478	,&
67.947	,&
67.72987	,&
67.51334	,&
67.29747	,&
67.08219	,&
66.86754	,&
66.65349	,&
66.44005	,&
66.2272	,&
66.01497	,&
65.80331	,&
65.59225	,&
65.38176	,&
65.17187	,&
64.96253	,&
64.75378	,&
64.54559	,&
64.33797	,&
64.13089	,&
63.9244	,&
63.71844	,&
63.51305	,&
63.3082	,&
63.10391	,&
62.90015	,&
62.69696	,&
62.4943	,&
62.29219	,&
62.09061	,&
61.88959	,&
61.68909	,&
61.48916	,&
61.28975	,&
61.09089	,&
60.89256	,&
60.69478	,&
60.49752	,&
60.30081	,&
60.10461	,&
59.90897	,&
59.71383	,&
59.51923	,&
59.32513	,&
59.13158	,&
58.93855	,&
58.74606	,&
58.55408	,&
58.36266	,&
58.17177	,&
57.98143	,&
57.79162	,&
57.60239	,&
57.4137	,&
57.22558	,&
57.03798	,&
56.85091	,&
56.66438	,&
56.47842	,&
56.293	,&
56.10815	,&
55.92388	,&
55.7402	,&
55.55711	,&
55.37463	,&
55.19276	,&
55.01153	,&
54.83092	,&
54.65096	,&
54.47164	,&
54.293	,&
54.115	,&
53.93769	,&
53.76107	,&
53.58516	,&
53.40993	,&
53.23543	,&
53.06165	,&
52.88861	,&
52.7163	,&
52.54475	,&
52.37396	,&
52.20395	,&
52.03472	,&
51.86628	,&
51.69864	,&
51.53182	,&
51.36581	,&
51.20065	,&
51.03632	,&
50.87286	,&
50.71025	,&
50.54853	,&
50.3877	,&
50.22777	,&
50.06715	,&
49.90751	,&
49.74884	,&
49.59118	,&
49.43451	,&
49.27887	,&
49.12425	,&
48.97069	,&
48.81816	,&
48.66672	,&
48.51635	,&
48.36708	,&
48.2189	,&
48.07186	,&
47.92595	,&
47.7812	,&
47.63761	,&
47.49521	,&
47.35401	,&
47.21403	,&
47.07529	,&
46.9378	,&
46.80159	,&
46.66668	,&
46.53308	,&
46.40082	,&
46.26991	,&
46.14039	,&
46.01227	,&
45.88558	,&
45.76035	,&
45.63661	,&
45.51437	,&
45.39368	,&
45.27455	,&
45.15702	,&
45.04113	,&
44.92691	,&
44.81439	,&
44.70362	,&
44.59463	,&
44.48746	,&
44.38217	,&
44.27879	,&
44.17736	,&
44.07795	,&
43.9806	,&
43.88537	,&
43.79231	,&
43.7015	,&
43.61298	,&
43.52683	,&
43.44312	,&
43.3619	,&
43.28328	,&
43.20733	,&
43.13412	,&
43.06376	,&
42.99633	,&
42.93192	,&
42.87066	,&
42.81263	,&
42.75796	,&
42.70676	,&
42.65916	,&
42.61529	,&
42.57529	,&
42.53931	,&
42.50749	,&
42.47999	,&
42.45698	,&
42.43863	,&
42.42512	,&
42.41664	,&
42.41337	,&
42.41552	,&
42.42329	,&
42.43689	,&
42.45654	,&
42.48249	,&
42.51497	,&
42.55423	,&
42.60055	,&
42.6542	,&
42.71545	,&
42.7846	,&
42.86196	,&
42.94772	,&
43.04222	,&
43.14578	,&
43.25873	,&
43.38142	,&
43.51419	,&
43.65739	,&
43.81139	,&
43.97653	,&
44.15319	,&
44.34174	,&
44.54253	,&
44.75593	,&
44.9823	,&
45.22202	,&
45.47544	,&
45.7429	,&
46.02478	,&
46.32138	,&
46.63307	,&
46.95689	,&
47.29635	,&
47.65175	,&
48.0234	,&
48.41155	,&
48.81647	,&
49.23839	,&
49.67753	,&
50.1341	,&
50.60828	,&
51.1002	,&
51.61005	,&
52.13789	,&
52.68383	,&
53.24793	,&
53.83022	,&
54.43071	,&
55.04938	,&
55.68616	,&
56.34101	,&
57.01379	,&
57.70436	,&
58.41257	,&
59.13822	,&
59.88107	,&
60.64089	,&
61.41737	,&
62.21024	,&
63.01913	,&
63.8437	,&
64.68356	,&
65.53831	,&
66.40749	,&
67.29068	,&
68.18738	,&
69.09711	,&
70.01935	,&
70.95358	,&
71.89925	,&
72.8558	,&
73.82264	,&
74.79922	,&
75.78491	,&
76.77914	,&
77.78128	,&
78.79073	,&
79.80683	,&
80.82898	,&
81.85654	,&
82.88887	,&
83.92535	,&
84.96537	,&
86.00827	,&
87.05345	,&
88.1003	,&
89.1482	,&
90.19653	,&
91.24474	,&
92.29222	,&
93.3384	,&
94.38272	,&
95.42465	,&
96.46362	,&
97.49913	,&
98.53064	,&
99.55772	,&
100.57982	,&
101.59653	,&
102.60737	,&
103.61194	,&
104.6098	,&
105.60056	,&
106.58384	,&
107.55928	,&
108.52652	,&
109.48524	,&
110.43513	,&
111.37589	,&
112.30722	,&
113.2289	,&
114.14064	,&
115.04224	,&
115.93347	,&
116.81415	,&
117.68407	,&
118.54308	,&
119.39101	,&
120.22777	,&
121.05318	,&
121.86715	,&
122.66958	,&
123.46038	,&
124.23947	,&
125.00684	,&
125.76237	,&
126.50609	,&
127.23792	,&
127.95786	,&
128.66591	,&
129.36206	,&
130.04634	,&
130.71877	,&
131.37938	,&
132.02818	,&
132.66525	,&
133.29063	,&
133.90436	,&
134.50653	,&
135.09718	,&
135.67644	,&
136.24435	,&
136.80103	,&
137.34653	,&
137.88098	,&
138.40448	,&
138.91713	,&
139.41901	,&
139.91026	,&
140.39098	,&
140.86128	,&
141.32129	,&
141.77115	,&
142.21094	,&
142.64082	,&
143.0609	,&
143.47131	,&
143.87218	,&
144.26363	,&
144.6458	,&
145.01881	,&
145.3828	,&
145.73792	,&
146.08429	,&
146.42201	,&
146.75125	,&
147.07213	,&
147.38478	,&
147.68932	,&
147.9859	,&
148.27464	,&
148.55566	,&
148.82912	,&
149.09509	,&
149.35374	,&
149.60518	,&
149.84955	,&
150.08694	,&
150.31752	,&
150.54138	,&
150.75865	,&
150.96942	,&
151.17387	,&
151.37206	,&
151.5641	,&
151.75015	,&
151.93031	,&
152.10464	,&
152.27332	,&
152.43639	,&
152.59401	,&
152.74628	,&
152.89326	,&
153.03508	,&
153.17184	,&
153.30363	,&
153.43059	,&
153.55275	,&
153.67024	,&
153.78314	,&
153.89157	,&
153.99559	,&
154.09528	,&
154.19075	,&
154.28209	,&
154.36938	,&
154.4527	,&
154.53212	,&
154.60774	,&
154.67961	,&
154.74785	,&
154.81252	,&
154.87366	,&
154.93137	,&
154.98575	,&
155.03682	,&
155.0847	,&
155.12941	,&
155.17105	,&
155.20967	,&
155.24535	,&
155.27814	,&
155.30811	,&
155.33531	,&
155.35982	,&
155.3817	,&
155.40102	,&
155.4178	,&
155.43213	,&
155.44403	,&
155.45357	,&
155.46082	,&
155.46584	,&
155.46864	,&
155.4693	,&
155.46785	,&
155.46437	,&
155.45888	,&
155.45145	,&
155.44209	,&
155.43089	,&
155.41786	,&
155.40306	,&
155.38654	,&
155.36833	,&
155.3485	,&
155.32703	,&
155.30402	,&
155.27948	,&
155.25346	,&
155.22601	,&
155.19713	,&
155.1669	,&
155.1353	,&
155.10245	,&
155.0683	,&
155.03293	,&
154.99637	,&
154.95863	,&
154.91977	,&
154.87981	,&
154.83879	,&
154.79675	,&
154.75366	,&
154.70964	,&
154.66466	,&
154.61877	,&
154.57198	,&
154.52435	,&
154.47588	,&
154.42661	,&
154.37654	,&
154.32574	,&
154.27422	,&
154.222	,&
154.1691	,&
154.11554	,&
154.06137	,&
154.00662	,&
153.95126	,&
153.89537	,&
153.83894	,&
153.78201	,&
153.72459	,&
153.66672	,&
153.60837	,&
153.54962	,&
153.49046	,&
153.43094	,&
153.37106	,&
153.31085	,&
153.25031	,&
153.18947	,&
153.12836	,&
153.06697	,&
153.00536	,&
152.94351	,&
152.88144	,&
152.81921	,&
152.75681	,&
152.69423	,&
152.63153	,&
152.56873	,&
152.5058	,&
152.44279	,&
152.3797	,&
152.31659	,&
152.25342	,&
152.19025	,&
152.12703	,&
152.06386	,&
152.00069	,&
151.93756	,&
151.87448	,&
151.81151	,&
151.7486	,&
151.68579	,&
151.62308	,&
151.56052	,&
151.49806	,&
151.43576	,&
151.37364	,&
151.31169	,&
151.24992	,&
151.18839	,&
151.12706	,&
151.06596	,&
151.0051	,&
150.9445	,&
150.88416	,&
150.8241	,&
150.7643	,&
150.70483	,&
150.64566	,&
150.58685	,&
150.52835	,&
150.4702	,&
150.4124	,&
150.35498	,&
150.29794	,&
150.24129	,&
150.18503	,&
150.1292	,&
150.07378	,&
150.01878	,&
149.96423	,&
149.91014	,&
149.85651	,&
149.80333	,&
149.75064	,&
149.69847	,&
149.64677	,&
149.5956	,&
149.54492	,&
149.4948	,&
149.44518	,&
149.39613	,&
149.34761	,&
149.29968	,&
149.2523	,&
149.20551	,&
149.15929	,&
149.11366	,&
149.06863	,&
149.02425	,&
148.98045	,&
148.93729	,&
148.89474	,&
148.85287	,&
148.81161	,&
148.77104	,&
148.73112	,&
148.69186	,&
148.65327	,&
148.61537	,&
148.57816	,&
148.54166	,&
148.50586	,&
148.47079	,&
148.43642	,&
148.40279	,&
148.36986	,&
148.33769	,&
148.30626	,&
148.27557	,&
148.24564	,&
148.21648	,&
148.18808	,&
148.16045	,&
148.13358	,&
148.10751	,&
148.08221	,&
148.05772	,&
148.03403	,&
148.01112	,&
147.98901	,&
147.96774	,&
147.94727	,&
147.92761	,&
147.9088	,&
147.89081	,&
147.87363	,&
147.85728	,&
147.8418	,&
147.82716	,&
147.81335	,&
147.80043	,&
147.78835	,&
147.77713	,&
147.76677	,&
147.75726	,&
147.74863	,&
147.74088	,&
147.73398	,&
147.72798	,&
147.72285	,&
147.71861	,&
147.71526	,&
147.7128	,&
147.71121	,&
147.71053	,&
147.71071	,&
147.71182	,&
147.71381	,&
147.71669	,&
147.72049	,&
147.72519	,&
147.73077	,&
147.73727	,&
147.74467	,&
147.75298	,&
147.76218	,&
147.77229	,&
147.78331	,&
147.79523	,&
147.80803	,&
147.82175	,&
147.8364	,&
147.85194	,&
147.86838	,&
147.88571	,&
147.90396	,&
147.92311	,&
147.94316	,&
147.9641	,&
147.98593	,&
148.00868	,&
148.03232	,&
148.05685	,&
148.08228	,&
148.10858	,&
148.1358	,&
148.16388	,&
148.19287	,&
148.22272	,&
148.25346	,&
148.28508	,&
148.31755	,&
148.35092	,&
148.38513	,&
148.42023	,&
148.45616	,&
148.49297	,&
148.53061	,&
148.56911	,&
148.60844	,&
148.64864	,&
148.68965	,&
148.73152	,&
148.77422	,&
148.81773	,&
148.86206	,&
148.90723	,&
148.95319	,&
148.99995	,&
149.0475	,&
149.09586	,&
149.145	,&
149.19493	,&
149.24564	,&
149.2971	,&
149.34935	,&
149.40236	,&
149.45612	,&
149.51062	,&
149.56589	,&
149.62189	,&
149.67859	,&
149.73604	,&
149.79417	,&
149.85304	,&
149.91261	,&
149.97289	,&
150.03384	,&
150.09547	,&
150.15778	,&
150.22075	,&
150.28438	,&
150.34866	,&
150.41359	,&
150.47914	,&
150.54536	,&
150.61217	,&
150.67961	,&
150.74763	,&
150.81625	,&
150.88548	,&
150.95528	,&
151.02563	,&
151.09656	,&
151.16805	,&
151.24008	,&
151.31267	,&
151.38576	,&
151.4594	,&
151.53352	,&
151.60817	,&
151.68332	,&
151.75893	,&
151.83502	,&
151.91159	,&
151.98862	,&
152.0661	,&
152.14401	,&
152.22237	,&
152.30113	,&
152.38031	,&
152.4599	,&
152.53989	,&
152.62025	,&
152.701	,&
152.78212	,&
152.8636	,&
152.9454	,&
153.02757	,&
153.11008	,&
153.1929	,&
153.27603	,&
153.35947	,&
153.44319	,&
153.52721	,&
153.6115	,&
153.69606	,&
153.78087	,&
153.86592	,&
153.95122	,&
154.03676	,&
154.12248	,&
154.20844	,&
154.29457	,&
154.38092	,&
154.46747	,&
154.55418	,&
154.64105	,&
154.72809	,&
154.81526	,&
154.90259	,&
154.99005	,&
155.07764	,&
155.16533	,&
155.25313	,&
155.34102	,&
155.429	,&
155.51706	,&
155.60519	,&
155.69339	,&
155.78163	,&
155.86993	,&
155.95827	,&
156.04663	,&
156.13501	,&
156.22342	,&
156.31181	,&
156.40021	,&
156.4886	,&
156.57698	,&
156.66533	,&
156.75363	,&
156.8419	,&
156.93013	,&
157.01831	,&
157.1064	,&
157.19444	,&
157.28241	,&
157.37029	,&
157.45807	,&
157.54576	,&
157.63333	,&
157.72079	,&
157.80817	,&
157.89539	,&
157.9825	,&
158.06947	,&
158.15627	,&
158.24292	,&
158.32944	,&
158.4158	,&
158.50198	,&
158.588	,&
158.67384	,&
158.75948	,&
158.84494	,&
158.93019	,&
159.01526	,&
159.10011	,&
159.18475	,&
159.26918	,&
159.35339	,&
159.43736	,&
159.5211	,&
159.6046	,&
159.68785	,&
159.77087	,&
159.85365	,&
159.93616	,&
160.0184	,&
160.10039	,&
160.1821	,&
160.26357	,&
160.34473	,&
160.42564	,&
160.50627	,&
160.58661	,&
160.66664	,&
160.74638	,&
160.82584	,&
160.905	,&
160.98384	,&
161.06239	,&
161.14061	,&
161.21854	,&
161.29614	,&
161.37343	,&
161.45039	,&
161.52704	,&
161.60335	,&
161.67935	,&
161.755	,&
161.83032	,&
161.90532	,&
161.97995	,&
162.05426	,&
162.12823	,&
162.20186	,&
162.27513	,&
162.34808	,&
162.42067	,&
162.4929	,&
162.5648	,&
162.63634	,&
162.70752	,&
162.77835	,&
162.84882	,&
162.91891	,&
162.98865	,&
163.05801	,&
163.12703	,&
163.19569	,&
163.26398	,&
163.33191	,&
163.39948	,&
163.46667	,&
163.53351	,&
163.59996	,&
163.66605	,&
163.73177	,&
163.79712	,&
163.86211	,&
163.92674	,&
163.99098	,&
164.05487	,&
164.11836	,&
164.1815	,&
164.24428	,&
164.30669	,&
164.36871	,&
164.43037	,&
164.49167	,&
164.55258	,&
164.61313	,&
164.67329	,&
164.73311	,&
164.79256	,&
164.85164	,&
164.91034	,&
164.96869	,&
165.02667	,&
165.08429	,&
165.14153	,&
165.19841	,&
165.25496	,&
165.31111	,&
165.3669	,&
165.42233	,&
165.4774	,&
165.53212	,&
165.58647	,&
165.64046	,&
165.69409	,&
165.74739	,&
165.80032	,&
165.85289	,&
165.90512	,&
165.95699	,&
166.00853	,&
166.05969	,&
166.1105	,&
166.161	,&
166.21114	,&
166.26091	,&
166.31036	,&
166.35948	,&
166.40825	,&
166.45667	,&
166.50476	,&
166.55254	,&
166.59996	,&
166.64705	,&
166.69382	,&
166.74023	,&
166.78633	,&
166.83211	,&
166.87756	,&
166.92268	,&
166.9675	,&
167.01199	,&
167.05615	,&
167.09999	,&
167.14351	,&
167.18672	,&
167.22963	,&
167.27222	,&
167.31448	,&
167.35646	,&
167.39812	,&
167.43947	,&
167.48053	,&
167.52129	,&
167.56174	,&
167.6019	,&
167.64175	,&
167.68134	,&
167.72061	,&
167.75961	,&
167.79831	,&
167.83672	,&
167.87485	,&
167.91269	,&
167.95026	,&
167.98755	,&
168.02455	,&
168.06128	,&
168.09773	,&
168.13391	,&
168.16982	,&
168.20544	,&
168.24083	,&
168.27594	,&
168.31081	,&
168.34538	,&
168.37973	,&
168.4138	,&
168.4476	,&
168.48117	,&
168.51447	,&
168.54753	,&
168.58034	,&
168.61288	,&
168.6452	,&
168.67728	,&
168.70911	,&
168.74069	,&
168.77206	,&
168.80319	,&
168.83409	,&
168.86475	,&
168.89516	,&
168.92535	,&
168.95534	,&
168.98508	,&
169.0146	,&
169.0439	,&
169.073	,&
169.10187	,&
169.13052	,&
169.15895	,&
169.18718	,&
169.21518	,&
169.24298	,&
169.27057	,&
169.29797	,&
169.32516	,&
169.35217	,&
169.37897	,&
169.40555	,&
169.43195	,&
169.45816	,&
169.48419	,&
169.51001	,&
169.53564	,&
169.5611	,&
169.58636	,&
169.61143	,&
169.63634	,&
169.66104	,&
169.68558	,&
169.70995	,&
169.73415	,&
169.75816	,&
169.78203	,&
169.80571	,&
169.82922	,&
169.85257	,&
169.87576	,&
169.89879	,&
169.92166	,&
169.94437	,&
169.96692	,&
169.98932	,&
170.01157	,&
170.03366	,&
170.05559	,&
170.07739	,&
170.09906	,&
170.12056	,&
170.14192	,&
170.16315	,&
170.18423	,&
170.20518	,&
170.226	,&
170.24667	,&
170.26723	,&
170.28764	,&
170.30794	,&
170.32809	,&
170.34811	,&
170.36804	,&
170.38783	,&
170.4075	,&
170.42703	,&
170.44647	,&
170.46579	,&
170.485	,&
170.50409	,&
170.52307	,&
170.54195	,&
170.5607	,&
170.57938	,&
170.59793	,&
170.61638	,&
170.63474	,&
170.653	,&
170.67116	,&
170.68921	,&
170.70718	,&
170.72507	,&
170.74287	,&
170.76057	,&
170.77818	,&
170.79575	,&
170.8132	,&
170.8306	,&
170.84787	,&
170.8651	,&
170.88222	,&
170.89929	,&
170.91629	,&
170.93321	,&
170.95006	,&
170.96684	,&
170.98357	,&
171.00021	,&
171.0168	,&
171.03333	,&
171.04979	,&
171.06619	,&
171.08255	,&
171.09885	,&
171.1151	,&
171.13129	,&
171.14743	,&
171.16351	,&
171.17955	,&
171.19556	,&
171.2115	,&
171.22742	,&
171.2433	,&
171.25911	,&
171.2749	,&
171.29066	,&
171.3064	,&
171.32208	,&
171.33774	,&
171.35338	,&
171.36897	,&
171.38454	,&
171.40009	,&
171.41562	,&
171.43112	,&
171.44659	,&
171.46205	,&
171.47751	,&
171.49294	,&
171.50835	,&
171.52374	,&
171.53915	,&
171.55453	,&
171.56992	,&
171.58527	,&
171.60063	,&
171.616	,&
171.63135	,&
171.64671	,&
171.66206	,&
171.67743	,&
171.69278	,&
171.70815	,&
171.72353	,&
171.73891	,&
171.7543	,&
171.76968	,&
171.78511	,&
171.80052	,&
171.81598	,&
171.83144	,&
171.84691	,&
171.86241	,&
171.87794	,&
171.89348	,&
171.90906	,&
171.92467	,&
171.94029	,&
171.95595	,&
171.97162	,&
171.98735	,&
172.00311	,&
172.01891	,&
172.03473	,&
172.0506	,&
172.06648	,&
172.08243	,&
172.09842	,&
172.11444	,&
172.13049	,&
172.14661	,&
172.16275	,&
172.17894	,&
172.19519	,&
172.2115	,&
172.22786	,&
172.24426	,&
172.26074	,&
172.27727	,&
172.29384	,&
172.31049	,&
172.32719	,&
172.34396	,&
172.36078	,&
172.37767	,&
172.39462	,&
172.41164	,&
172.42873	,&
172.44588	,&
172.4631	,&
172.48039	,&
172.49776	,&
172.5152	,&
172.53271	,&
172.55031	,&
172.56798	,&
172.58571	,&
172.60355	,&
172.62144	,&
172.63943	,&
172.65752	,&
172.67566	,&
172.69391	,&
172.71223	,&
172.73065	,&
172.74915	,&
172.76773	,&
172.78641	,&
172.80516	,&
172.82402	,&
172.84297	,&
172.86203	,&
172.88116	,&
172.90039	,&
172.91974	,&
172.93916	,&
172.95869	,&
172.97832	,&
172.99805	,&
173.01787	,&
173.03783	,&
173.05786	,&
173.078	,&
173.09824	,&
173.11861	,&
173.13907	,&
173.15962	,&
173.1803	,&
173.20107	,&
173.22197	,&
173.24297	,&
173.26408	,&
173.28531	,&
173.30664	,&
173.32811	,&
173.34964	,&
173.37132	,&
173.3931	,&
173.41499	,&
173.437	,&
173.45914	,&
173.48138	,&
173.50374	,&
173.52623	,&
173.54883	,&
173.57155	,&
173.59438	,&
173.61732	,&
173.64041	,&
173.6636	,&
173.68692	,&
173.71034	,&
173.7339	,&
173.75758	,&
173.78137	,&
173.8053	,&
173.82933	,&
173.8535	,&
173.87779	,&
173.90221	,&
173.92674	,&
173.95142	,&
173.9762	,&
174.0011	,&
174.02612	,&
174.05128	,&
174.07657	,&
174.10199	,&
174.12752	,&
174.15318	,&
174.17896	,&
174.20485	,&
174.2309	,&
174.25705	,&
174.28336	,&
174.30975	,&
174.33629	,&
174.36293	,&
174.38971	,&
174.4166	,&
174.44363	,&
174.47078	,&
174.49808	,&
174.5255	,&
174.55302	,&
174.58067	,&
174.60846	,&
174.63635	,&
174.66438	,&
174.69254	,&
174.72083	,&
174.74922	,&
174.77776	,&
174.8064	,&
174.83517	,&
174.86406	,&
174.89307	,&
174.92221	,&
174.95146	,&
174.98085	,&
175.01035	,&
175.03995	,&
175.06969	,&
175.09955	,&
175.12953	,&
175.15962	,&
175.18983	,&
175.22014	,&
175.2506	,&
175.28114	,&
175.31183	,&
175.34261	,&
175.37352	,&
175.40454	,&
175.43567	,&
175.4669	,&
175.49828	,&
175.52974	,&
175.56131	,&
175.59302	,&
175.6248	,&
175.65669	,&
175.68869	,&
175.72081	,&
175.75304	,&
175.78537	,&
175.81779	,&
175.85033	,&
175.88293	,&
175.91568	,&
175.94852	,&
175.98145	,&
176.01445	,&
176.04756	,&
176.08076	,&
176.11407	,&
176.14746	,&
176.18094	,&
176.21452	,&
176.2482	,&
176.28194	,&
176.31578	,&
176.34972	,&
176.38374	,&
176.41785	,&
176.45204	,&
176.4863	,&
176.52065	,&
176.55507	,&
176.58957	,&
176.62415	,&
176.65878	,&
176.69351	,&
176.72832	,&
176.76318	,&
176.79811	,&
176.83311	,&
176.86819	,&
176.90332	,&
176.93851	,&
176.97374	,&
177.00906	,&
177.04442	,&
177.07985	,&
177.11534	,&
177.15088	,&
177.18646	,&
177.22211	,&
177.25778	,&
177.2935	,&
177.32928	,&
177.3651	,&
177.40094	,&
177.43681	,&
177.47272	,&
177.50865	,&
177.54462	,&
177.58061	,&
177.61665	,&
177.65269	,&
177.68878	,&
177.72487	,&
177.76099	,&
177.79712	,&
177.83327	,&
177.86943	,&
177.90561	,&
177.9418	,&
177.978	,&
178.01419	,&
178.0504	,&
178.08661	,&
178.12283	,&
178.15904	,&
178.19527	,&
178.23146	,&
178.26768	,&
178.30388	,&
178.34007	,&
178.37627	,&
178.41245	,&
178.44861	,&
178.48476	,&
178.5209	,&
178.55704	,&
178.59314	,&
178.62924	,&
178.66533	,&
178.70137	,&
178.73743	,&
178.77342	,&
178.8094	,&
178.84535	,&
178.8813	,&
178.91719	,&
178.95306	,&
178.98889	,&
179.02469	,&
179.06046	,&
179.09618	,&
179.13187	,&
179.16751	,&
179.20309	,&
179.23865	,&
179.27415	,&
179.30962	,&
179.34502	,&
179.3804	,&
179.41571	,&
179.45099	,&
179.48619	,&
179.52135	,&
179.55643	,&
179.59146	,&
179.62643	,&
179.66132	,&
179.69615	,&
179.73091	,&
179.76562	,&
179.80026	,&
179.83482	,&
179.86931	,&
179.90372	,&
179.93806	,&
179.97232	,&
180.0065	,&
180.04059	,&
180.07462	,&
180.10854	,&
180.14238	,&
180.17615	,&
180.20979	,&
180.24338	,&
180.27686	,&
180.31026	,&
180.34357	,&
180.37677	,&
180.40988	,&
180.4429	,&
180.4758	,&
180.50862	,&
180.54132	,&
180.57393	,&
180.60643	,&
180.63881	,&
180.67111	,&
180.70329	,&
180.73535	,&
180.76732	,&
180.79916	,&
180.83089	,&
180.86249	,&
180.89398	,&
180.92535	,&
180.95662	,&
180.98776	,&
181.0188	,&
181.04968	,&
181.08046	,&
181.11111	,&
181.14165	,&
181.17204	,&
181.20232	,&
181.23247	,&
181.26248	,&
181.29236	,&
181.32213	,&
181.35175	,&
181.38124	,&
181.4106	,&
181.43982	,&
181.46892	,&
181.49788	,&
181.52669	,&
181.55534	,&
181.58389	,&
181.61229	,&
181.64055	,&
181.66864	,&
181.69662	,&
181.72447	,&
181.75217	,&
181.77972	,&
181.80713	,&
181.8344	,&
181.86151	,&
181.88847	,&
181.91531	,&
181.942	,&
181.96854	,&
181.99492	,&
182.02115	,&
182.04721	,&
182.07315	,&
182.09894	,&
182.12457	,&
182.15007	,&
182.17542	,&
182.20061	,&
182.22565	,&
182.25052	,&
182.27525	,&
182.29982	,&
182.32423	,&
182.34851	,&
182.37262	,&
182.39659	,&
182.42039	,&
182.44405	,&
182.46753	,&
182.49088	,&
182.51407	,&
182.53709	,&
182.55998	,&
182.5827	,&
182.60527	,&
182.62769	,&
182.64995	,&
182.67206	,&
182.69402	,&
182.71582	,&
182.73746	,&
182.75894	,&
182.78027	,&
182.80145	,&
182.82248	,&
182.84334	,&
182.86406	,&
182.88463	,&
182.90503	,&
182.92528	,&
182.94537	,&
182.96532	,&
182.98511	,&
183.00475	,&
183.02423	,&
183.04356	,&
183.06274	,&
183.08177	,&
183.10065	,&
183.11935	,&
183.13792	,&
183.15636	,&
183.17462	,&
183.19273	,&
183.21069	,&
183.22852	,&
183.24619	,&
183.2637	,&
183.28107	,&
183.29828	,&
183.31537	,&
183.33231	,&
183.34908	,&
183.36571	,&
183.38219	,&
183.39851	,&
183.4147	,&
183.43074	,&
183.44664	,&
183.46239	,&
183.47801	,&
183.49348	,&
183.50882	,&
183.524	,&
183.53903	,&
183.55394	,&
183.5687	,&
183.58331	,&
183.59781	,&
183.61215	,&
183.62636	,&
183.64043	,&
183.65436	,&
183.66818	,&
183.68184	,&
183.69536	,&
183.70874	,&
183.72198	,&
183.73509	,&
183.74808	,&
183.76094	,&
183.77368	,&
183.78629	,&
183.79875	,&
183.81108	,&
183.82329	,&
183.83536	,&
183.84731	,&
183.85913	,&
183.87083	,&
183.8824	,&
183.89383	,&
183.90515	,&
183.91635	,&
183.92741	,&
183.93835	,&
183.94919	,&
183.95988	,&
183.97046	,&
183.98093	,&
183.99127	,&
184.00151	,&
184.01163	,&
184.02162	,&
184.03151	,&
184.04129	,&
184.05092	,&
184.06044	,&
184.06985	,&
184.07916	,&
184.08836	,&
184.09744	,&
184.10643	,&
184.1153	,&
184.12405	,&
184.13271	,&
184.14124	,&
184.14967	,&
184.15799	,&
184.1662	,&
184.17433	,&
184.18233	,&
184.19025	,&
184.19804	,&
184.20575	,&
184.21336	,&
184.22084	,&
184.22823	,&
184.23552	,&
184.24271	,&
184.24982	,&
184.25682	,&
184.2637	,&
184.27051	,&
184.27721	,&
184.28383	,&
184.29036	,&
184.29678	,&
184.30312	,&
184.30936	,&
184.31554	,&
184.32159	,&
184.32756	,&
184.33344	,&
184.33922	,&
184.34491	,&
184.35054	,&
184.35605	,&
184.3615	,&
184.36684	,&
184.3721	,&
184.37727	,&
184.38235	,&
184.38736	,&
184.39229	,&
184.39714	,&
184.4019	,&
184.40659	,&
184.41118	,&
184.41571	,&
184.42015	,&
184.4245	,&
184.42877	,&
184.43297	,&
184.43712	,&
184.44118	,&
184.44514	,&
184.44904	,&
184.45287	,&
184.4566	,&
184.46028	,&
184.46388	,&
184.46741	,&
184.47089	,&
184.47424	,&
184.47754	,&
184.48076	,&
184.48393	,&
184.48703	,&
184.49004	,&
184.49298	,&
184.49586	,&
184.49867	,&
184.50142	,&
184.50409	,&
184.50668	,&
184.50923	,&
184.51172	,&
184.51411	,&
184.51643	,&
184.51869	,&
184.52089	,&
184.52304	,&
184.52512	,&
184.52711	,&
184.52905	,&
184.53093	,&
184.53276	,&
184.5345	,&
184.53621	,&
184.53783	,&
184.53938	,&
184.54089	,&
184.54233	,&
184.5437	,&
184.54501	,&
184.54626	,&
184.54747	,&
184.5486	,&
184.54967	,&
184.55067	,&
184.55164	,&
184.55252	,&
184.55334	,&
184.55412	,&
184.55484	,&
184.55551	,&
184.55611	,&
184.55666	,&
184.55714	,&
184.55757	,&
184.55794	,&
184.55824	,&
184.55849	,&
184.55869	,&
184.55884	,&
184.55894	,&
184.55898	,&
184.55894	,&
184.55885	,&
184.55872	,&
184.55853	,&
184.55827	,&
184.55795	,&
184.55759	,&
184.55716	,&
184.5567	,&
184.55617	,&
184.5556	,&
184.55496	,&
184.55426	,&
184.55351	,&
184.55272	,&
184.55186	,&
184.55096	,&
184.55	,&
184.54898	,&
184.54791	,&
184.54681	,&
184.54564	,&
184.54442	,&
184.54314	,&
184.54181	,&
184.54044	,&
184.539	,&
184.53752	,&
184.536	,&
184.53441	,&
184.53278	,&
184.5311	,&
184.52936	,&
184.52756	,&
184.52571	,&
184.52382	,&
184.52187	,&
184.51985	,&
184.51782	,&
184.51572	,&
184.51358	,&
184.5114	,&
184.50914	,&
184.50684	,&
184.50452	,&
184.50212	,&
184.49966	,&
184.49718	,&
184.49463	,&
184.49203	,&
184.4894	,&
184.48672	,&
184.48399	,&
184.4812	,&
184.47836	,&
184.47548	,&
184.47255	,&
184.46957	,&
184.46655	,&
184.46347	,&
184.46033	,&
184.45714	,&
184.45392	,&
184.45064	,&
184.4473	,&
184.44394	,&
184.44052	,&
184.43704	,&
184.43352	,&
184.42996	,&
184.42636	,&
184.4227	,&
184.41899	,&
184.41524	,&
184.41144	,&
184.40759	,&
184.4037	,&
184.39977	,&
184.39578	,&
184.39175	,&
184.3877	,&
184.38358	,&
184.37941	,&
184.37521	,&
184.37099	,&
184.3667	,&
184.36237	,&
184.35797	,&
184.35353	,&
184.34906	,&
184.34454	,&
184.34	,&
184.33539	,&
184.33075	,&
184.32607	,&
184.32132	,&
184.31656	,&
184.31172	,&
184.30685	,&
184.30196	,&
184.297	,&
184.29201	,&
184.28696	,&
184.28188	,&
184.27676	,&
184.27161	,&
184.2664	,&
184.26115	,&
184.25587	,&
184.25055	,&
184.24519	,&
184.23979	,&
184.23433	,&
184.22885	,&
184.22333	,&
184.21776	,&
184.21214	,&
184.20648	,&
184.20079	,&
184.19507	,&
184.1893	,&
184.18349	,&
184.17764	,&
184.17175	,&
184.16583	,&
184.15985	,&
184.15387	,&
184.14784	,&
184.14177	,&
184.13567	,&
184.12952	,&
184.12334	,&
184.11711	,&
184.11086	,&
184.10457	,&
184.09824	,&
184.09187	,&
184.08546	,&
184.07903	,&
184.07256	,&
184.06606	,&
184.05951	,&
184.05293	,&
184.04633	,&
184.03967	,&
184.033	,&
184.02629	,&
184.01955	,&
184.01276	,&
184.00595	,&
183.99911	,&
183.99225	,&
183.98534	,&
183.97839	,&
183.97141	,&
183.96442	,&
183.95737	,&
183.9503	,&
183.94321	,&
183.93608	,&
183.92892	,&
183.92174	,&
183.91451	,&
183.90724	,&
183.89995	,&
183.89264	,&
183.8853	,&
183.87794	,&
183.87056	,&
183.86314	,&
183.85568	,&
183.84821	,&
183.8407	,&
183.83318	,&
183.82561	,&
183.81801	,&
183.81038	,&
183.80273	,&
183.79506	,&
183.78735	,&
183.77963	,&
183.77188	,&
183.7641	,&
183.75627	,&
183.74847	,&
183.74059	,&
183.73273	,&
183.72482	,&
183.7169	,&
183.70894	,&
183.70094	,&
183.69293	,&
183.68491	,&
183.67685	,&
183.66878	,&
183.66069	,&
183.65257	,&
183.64444	,&
183.63628	,&
183.62808	,&
183.61989	,&
183.61166	,&
183.60341	,&
183.59514	,&
183.58685	,&
183.57852	,&
183.57019	,&
183.56183	,&
183.55344	,&
183.54504	,&
183.53662	,&
183.52818	,&
183.51973	,&
183.51125	,&
183.50275	,&
183.49423	,&
183.48569	,&
183.47711	,&
183.46854	,&
183.45995	,&
183.45134	,&
183.44272	,&
183.43407	,&
183.42542	,&
183.41673	,&
183.40804	,&
183.39931	,&
183.39059	,&
183.38185	,&
183.37308	,&
183.3643	,&
183.35551	,&
183.34668	,&
183.33784	,&
183.32899	,&
183.32013	,&
183.31125	,&
183.30235	,&
183.29346	,&
183.28452	,&
183.27559	,&
183.26663	,&
183.25768	,&
183.24869	,&
183.2397	,&
183.23068	,&
183.22165	,&
183.2126	,&
183.20355	,&
183.19449	,&
183.18541	,&
183.17632	,&
183.16722	,&
183.15808	,&
183.14894	,&
183.1398	,&
183.13065	,&
183.12149	,&
183.11232	,&
183.10312	,&
183.09392	,&
183.0847	,&
183.07549	,&
183.06627	,&
183.05704	,&
183.04778	,&
183.03851	,&
183.02925	,&
183.01997	,&
183.0107	,&
183.00137	,&
182.99207	,&
182.98274	,&
182.9734	,&
182.96408	,&
182.95473	,&
182.94539	,&
182.93604	,&
182.92667	,&
182.9173	,&
182.9079	,&
182.89851	,&
182.88911	,&
182.87971	,&
182.87029	,&
182.86089	,&
182.85147	,&
182.84204	,&
182.83258	,&
182.82314	,&
182.81371	,&
182.80424	,&
182.79477	,&
182.78531	,&
182.77585	,&
182.76637	,&
182.7569	,&
182.74741	,&
182.73793	,&
182.72844	,&
182.71893	,&
182.70944	,&
182.69994	,&
182.69041	,&
182.68091	,&
182.6714	,&
182.6619	,&
182.65239	,&
182.64284	,&
182.63332	,&
182.62379	,&
182.61426	,&
182.60474	,&
182.59521	,&
182.58568	,&
182.57613	,&
182.5666	,&
182.55707	,&
182.54755	,&
182.53799	,&
182.52847	,&
182.51894	,&
182.50938	,&
182.49985	,&
182.49031	,&
182.48077	,&
182.47125	,&
182.46173	,&
182.45219	,&
182.44269	,&
182.43315	,&
182.42363	,&
182.41409	,&
182.40459	,&
182.39508	,&
182.38556	,&
182.37605	,&
182.36655	,&
182.35706	,&
182.34756	,&
182.33807	,&
182.32857	,&
182.31909	,&
182.30959	,&
182.30011	,&
182.29065	,&
182.28117	,&
182.27173	,&
182.26228	,&
182.25282	,&
182.24339	,&
182.23396	,&
182.22453	,&
182.21512	,&
182.2057	,&
182.19627	,&
182.18686	,&
182.17746	,&
182.16808	,&
182.15869	,&
182.14931	,&
182.13994	,&
182.13057	,&
182.12122	,&
182.11188	,&
182.10252	,&
182.0932	,&
182.08388	,&
182.07455	,&
182.06526	,&
182.05597	,&
182.04669	,&
182.0374	,&
182.02814	,&
182.01889	,&
182.00963	,&
182.0004	,&
181.99117	,&
181.98195	,&
181.97273	,&
181.96353	,&
181.95436	,&
181.94518	,&
181.936	,&
181.92682	,&
181.91768	,&
181.90852	,&
181.89941	,&
181.89027	,&
181.88116	,&
181.87207	,&
181.86298	,&
181.85391	,&
181.84483	,&
181.83578	,&
181.82675	,&
181.81772	,&
181.8087	,&
181.7997	,&
181.7907	,&
181.78171	,&
181.77274	,&
181.76376	,&
181.75481	,&
181.74586	,&
181.73694	,&
181.72803	,&
181.71915	,&
181.71025	,&
181.70139	,&
181.69252	,&
181.68367	,&
181.67482	,&
181.666	,&
181.65717	,&
181.64838	,&
181.63959	,&
181.63083	,&
181.62206	,&
181.61331	,&
181.60457	,&
181.59584	,&
181.58711	,&
181.5784	,&
181.56969	,&
181.56102	,&
181.55234	,&
181.54369	,&
181.53505	,&
181.52643	,&
181.51779	,&
181.50919	,&
181.50056	,&
181.49196	,&
181.48338	,&
181.47479	,&
181.46623	,&
181.45767	,&
181.44914	,&
181.44061	,&
181.4321	,&
181.42358	,&
181.4151	,&
181.40662	,&
181.39816	,&
181.38969	,&
181.38124	,&
181.37279	,&
181.36435	,&
181.35593	,&
181.3475	,&
181.33911	,&
181.33069	,&
181.32231	,&
181.31392	,&
181.30553	,&
181.29718	,&
181.28882	,&
181.28049	,&
181.27214	,&
181.26382	,&
181.25549	,&
181.24716	,&
181.23886	,&
181.23055	,&
181.22226	,&
181.21396	,&
181.20566	,&
181.19739	,&
181.1891	,&
181.18083	,&
181.17258	,&
181.16431	,&
181.15607	,&
181.1478	,&
181.13956	,&
181.13132	,&
181.12308	,&
181.11485	,&
181.10663	,&
181.09839	,&
181.09018	,&
181.08197	,&
181.07378	,&
181.06555	,&
181.05734	,&
181.04913	,&
181.04092	,&
181.03273	,&
181.02452	,&
181.01633	,&
181.00813	,&
180.99992	,&
180.99173	,&
180.98354	,&
180.97531	,&
180.9671	,&
180.95891	,&
180.9507	,&
180.94249	,&
180.9343	,&
180.92609	,&
180.91786	,&
180.90967	,&
180.90144	,&
180.89322	,&
180.88501	,&
180.87679	,&
180.86856	,&
180.86035	,&
180.85211	,&
180.84387	,&
180.83563	,&
180.82738	,&
180.81912	,&
180.81088	,&
180.80261	,&
180.79434	,&
180.78606	,&
180.7778	,&
180.7695	,&
180.7612	,&
180.75291	,&
180.7446	,&
180.73627	,&
180.72795	,&
180.71962	,&
180.71127	,&
180.70291	,&
180.69458	,&
180.6862	,&
180.67783	,&
180.66943	,&
180.66106	,&
180.65265	,&
180.64423	,&
180.6358	,&
180.62737	,&
180.61891	,&
180.61046	,&
180.60201	,&
180.59351	,&
180.58501	,&
180.57651	,&
180.56799	,&
180.55945	,&
180.5509	,&
180.54236	,&
180.53378	,&
180.52521	,&
180.5166	,&
180.50798	,&
180.49934	,&
180.49072	,&
180.48206	,&
180.47339	,&
180.46471	,&
180.45601	,&
180.44733	,&
180.43861	,&
180.42987	,&
180.42113	,&
180.41235	,&
180.40358	,&
180.39478	,&
180.38596	,&
180.37711	,&
180.36826	,&
180.35939	,&
180.35049	,&
180.34158	,&
180.33267	,&
180.32375	,&
180.31479	,&
180.30585	,&
180.29686	,&
180.28786	,&
180.27884	,&
180.26979	,&
180.26073	,&
180.25165	,&
180.24257	,&
180.23346	,&
180.22435	,&
180.21521	,&
180.20604	,&
180.19685	,&
180.18765	,&
180.17847	,&
180.16924	,&
180.15997	,&
180.15071	,&
180.14142	,&
180.13211	,&
180.12279	,&
180.11343	,&
180.10408	,&
180.09468	,&
180.08528	,&
180.07585	,&
180.06641	,&
180.05696	,&
180.04749	,&
180.03798	,&
180.02844	,&
180.01891	,&
180.00934	,&
179.99974	,&
179.99017	,&
179.98055	,&
179.9709	,&
179.96124	,&
179.95155	,&
179.94186	,&
179.93213	,&
179.92238	,&
179.91261	,&
179.90283	,&
179.89302	,&
179.88319	,&
179.87332	,&
179.86343	,&
179.85355	,&
179.84364	,&
179.83371	,&
179.82375	,&
179.81375	,&
179.80376	,&
179.79373	,&
179.78369	,&
179.77362	,&
179.76355	,&
179.75345	,&
179.74335	,&
179.73322	,&
179.72305	,&
179.71288	 /)


        lake_area = 2.096320037841796875e+02
        weir_elevation = 1.332074047851562455e+03
        weir_coeffecient = 4.000000000000000222e-01
        weir_length = 1.000000000000000000e+01
        orifice_elevation = 1.314473347981770758e+03
        orifice_coefficient = 1.000000000000000056e-01
        orifice_area = 1.0
        max_depth = 1.335180053710937500e+03
        initial_fractional_depth = 8.999999761581420898e-01
        lake_number = 120052939


!print *, inflow_array


        print *, "calling init for persistence_levelpool_hybrid_struct"

        call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, lake_area, weir_elevation, &
        weir_coeffecient, weir_length, orifice_elevation, orifice_coefficient, orifice_area, max_depth, initial_fractional_depth, lake_number, "Testing_Files/persistence_reservoir_using_usgs_gages.nc", &
        "2010-10-01_07:00:00", ".", 12, 1000000000)





        print *, "testing data in persistence_levelpool_hybrid_struct"
        rv1 = persistence_levelpool_hybrid_data_info(persistence_levelpool_hybrid_reservoir_data)


        print *, "calling release for persistence_levelpool_hybrid_struct"


        !water_elevation = 1333.10938
        water_elevation = 1335.18005


        do timestep_count = 1, 2880

            inflow = inflow_array(timestep_count)
            call persistence_levelpool_hybrid_reservoir_data%run_release(inflow, &
            inflow, 0.0, water_elevation, outflow, 300.0)

            prev_time_inflow = inflow


        end do

        !print *, "outflow"
        !print *, outflow

        !if (outflow == 120.170197) then
        !    rv3 = .true.
        !    print *, "========================================================================"
        !    print *, 'Persistence Levelpool Hybrid Release Test Passed'
        !    print *, "========================================================================"
        !else
        !    print *, "========================================================================"
        !    print *, 'Persistence Levelpool Hybrid Release Test Failed'
        !    print *, 'Outflow should be 120.170197'
        !    print *, "========================================================================"
        !end if


        !if (rv1 .and. rv2 .and. rv3) then
        !    rv = .true.
        !end if

        if (rv1) then
            rv = .true.
        end if


    end function test_persistence_levelpool_hybrid5



    function test_persistence_levelpool_hybrid6() result(rv)
        implicit none

        logical rv                        ! test result

        type (persistence_levelpool_hybrid_struct) :: persistence_levelpool_hybrid_reservoir_data

        real :: inflow, water_elevation, outflow
        real :: lake_area, weir_elevation, weir_coeffecient
        real :: weir_length, orifice_elevation, orifice_coefficient
        real :: orifice_area, max_depth, initial_fractional_depth
        integer :: lake_number
        integer :: timestep_count, total_timesteps


    !Hard code gage discharge at line 210 in main hybrid module

    !Set array dimension here
    !!!!!!!!!!!!!!!!!
        real, dimension(100) :: inflow_array

        total_timesteps = 100
    !!!!!!!!!!!!!!!!!


    !Set initial water elevation here
    !!!!!!!!!!!!!!!!!
        water_elevation = 323.0
    !!!!!!!!!!!!!!!!!


    !Set static params here
    !!!!!!!!!!!!!!!!!
        lake_area = 2.096320037841796875e+02
        weir_elevation = 1.332074047851562455e+03
        weir_coeffecient = 4.000000000000000222e-01
        weir_length = 1.000000000000000000e+01
        orifice_elevation = 1.314473347981770758e+03
        orifice_coefficient = 1.000000000000000056e-01
        orifice_area = 1.0
        max_depth = 1.335180053710937500e+03
        initial_fractional_depth = 8.999999761581420898e-01
        lake_number = 120052939
    !!!!!!!!!!!!!!!!!


    !Copy inflow array here with ", &"
    !!!!!!!!!!!!!!!!!
        !inflow_array = (/0.000000000	, &


        !0.000000000	 /)
    !!!!!!!!!!!!!!!!!


    ! Do not modify
    !!!!!!!!!!!!!!!!!
        timestep_count = 0

        call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, lake_area, weir_elevation, &
        weir_coeffecient, weir_length, orifice_elevation, orifice_coefficient, orifice_area, max_depth, initial_fractional_depth, lake_number, "Testing_Files/persistence_reservoir_using_usgs_gages.nc", &
        "2010-10-01_07:00:00", ".", 12, 1000000000)

        do timestep_count = 1, total_timesteps

            inflow = inflow_array(timestep_count)
            call persistence_levelpool_hybrid_reservoir_data%run_release(inflow, &
            inflow, 0.0, water_elevation, outflow, 300.0)

        end do

        rv = .true.
    !!!!!!!!!!!!!!!!!

    end function test_persistence_levelpool_hybrid6



    function test_persistence_levelpool_hybrid7() result(rv)
        implicit none

        logical rv                        ! test result

        type (persistence_levelpool_hybrid_struct) :: persistence_levelpool_hybrid_reservoir_data

        real :: inflow, water_elevation, outflow
        real :: lake_area, weir_elevation, weir_coeffecient
        real :: weir_length, orifice_elevation, orifice_coefficient
        real :: orifice_area, max_depth, initial_fractional_depth
        integer :: lake_number
        integer :: timestep_count, total_timesteps


    !Hard code gage discharge at line 210 in main hybrid module

    !Set array dimension here
    !!!!!!!!!!!!!!!!!
        real, dimension(100) :: inflow_array

        total_timesteps = 100
    !!!!!!!!!!!!!!!!!


    !Set initial water elevation here
    !!!!!!!!!!!!!!!!!
        water_elevation = 323.0
    !!!!!!!!!!!!!!!!!


    !Set static params here
    !!!!!!!!!!!!!!!!!
        lake_area = 2.096320037841796875e+02
        weir_elevation = 1.332074047851562455e+03
        weir_coeffecient = 4.000000000000000222e-01
        weir_length = 1.000000000000000000e+01
        orifice_elevation = 1.314473347981770758e+03
        orifice_coefficient = 1.000000000000000056e-01
        orifice_area = 1.0
        max_depth = 1.335180053710937500e+03
        initial_fractional_depth = 8.999999761581420898e-01
        lake_number = 120052939
    !!!!!!!!!!!!!!!!!


    !Copy inflow array here with ", &"
    !!!!!!!!!!!!!!!!!
        !inflow_array = (/0.000000000	, &


        !0.000000000	 /)
    !!!!!!!!!!!!!!!!!


    ! Do not modify
    !!!!!!!!!!!!!!!!!
        timestep_count = 0

        call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, lake_area, weir_elevation, &
        weir_coeffecient, weir_length, orifice_elevation, orifice_coefficient, orifice_area, max_depth, initial_fractional_depth, lake_number, "Testing_Files/persistence_reservoir_using_usgs_gages.nc", &
        "2010-10-01_07:00:00", ".", 12, 1000000000)

        do timestep_count = 1, total_timesteps

            inflow = inflow_array(timestep_count)
            call persistence_levelpool_hybrid_reservoir_data%run_release(inflow, &
            inflow, 0.0, water_elevation, outflow, 300.0)

        end do

        rv = .true.
    !!!!!!!!!!!!!!!!!

    end function test_persistence_levelpool_hybrid7



    function test_persistence_levelpool_hybrid8() result(rv)
        implicit none
        logical rv                        ! test result

        type (persistence_levelpool_hybrid_struct) :: persistence_levelpool_hybrid_reservoir_data

        real :: inflow, water_elevation, outflow
        real :: lake_area, weir_elevation, weir_coeffecient
        real :: weir_length, orifice_elevation, orifice_coefficient
        real :: orifice_area, max_depth, initial_fractional_depth
        integer :: lake_number
        integer :: timestep_count, total_timesteps


    !Hard code gage discharge at line 210 in main hybrid module

    !Set array dimension here
    !!!!!!!!!!!!!!!!!
        real, dimension(100) :: inflow_array

        total_timesteps = 100
    !!!!!!!!!!!!!!!!!


    !Set initial water elevation here
    !!!!!!!!!!!!!!!!!
        water_elevation = 323.0
    !!!!!!!!!!!!!!!!!


    !Set static params here
    !!!!!!!!!!!!!!!!!
        lake_area = 2.096320037841796875e+02
        weir_elevation = 1.332074047851562455e+03
        weir_coeffecient = 4.000000000000000222e-01
        weir_length = 1.000000000000000000e+01
        orifice_elevation = 1.314473347981770758e+03
        orifice_coefficient = 1.000000000000000056e-01
        orifice_area = 1.0
        max_depth = 1.335180053710937500e+03
        initial_fractional_depth = 8.999999761581420898e-01
        lake_number = 120052939
    !!!!!!!!!!!!!!!!!


    !Copy inflow array here with ", &"
    !!!!!!!!!!!!!!!!!
        !inflow_array = (/0.000000000	, &


        !0.000000000	 /)
    !!!!!!!!!!!!!!!!!


    ! Do not modify
    !!!!!!!!!!!!!!!!!
        timestep_count = 0

        call persistence_levelpool_hybrid_reservoir_data%init(water_elevation, lake_area, weir_elevation, &
        weir_coeffecient, weir_length, orifice_elevation, orifice_coefficient, orifice_area, max_depth, initial_fractional_depth, lake_number, "Testing_Files/persistence_reservoir_using_usgs_gages.nc", &
        "2010-10-01_07:00:00", ".", 12, 1000000000)

        do timestep_count = 1, total_timesteps

            inflow = inflow_array(timestep_count)
            call persistence_levelpool_hybrid_reservoir_data%run_release(inflow, &
            inflow, 0.0, water_elevation, outflow, 300.0)

        end do

        rv = .true.
    !!!!!!!!!!!!!!!!!

    end function test_persistence_levelpool_hybrid8



end program
